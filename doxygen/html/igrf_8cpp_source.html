<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>STF: stf/environment/models/igrf.cpp ソースファイル</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- 作成： Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'検索');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">STF</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>メインページ</span></a></li>
      <li><a href="pages.html"><span>関連ページ</span></a></li>
      <li><a href="namespaces.html"><span>ネームスペース</span></a></li>
      <li><a href="annotated.html"><span>クラス</span></a></li>
      <li class="current"><a href="files.html"><span>ファイル</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="検索" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>ファイル一覧</span></a></li>
      <li><a href="globals.html"><span>ファイルメンバ</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>stf/environment/models/igrf.cpp</h1>  </div>
</div>
<div class="contents">
<a href="igrf_8cpp.html">説明を見る。</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00008"></a>00008 <span class="comment">/**********************/</span>
<a name="l00009"></a>00009 <span class="comment">/***     igrf.c     ***/</span>
<a name="l00010"></a>00010 <span class="comment">/****************************************************************************/</span>
<a name="l00011"></a>00011 <span class="comment">/* Usage from FORTRAN :     ( All variables are in single precision )       */</span>
<a name="l00012"></a>00012 <span class="comment">/*      First specify the Generation Number with the Year of Calc.          */</span>
<a name="l00013"></a>00013 <span class="comment">/*          by  CALL gigrf(NGEN, YEAR),                                     */</span>
<a name="l00014"></a>00014 <span class="comment">/*        or specify the Model Type (IGRF/DGRF/PGRF) with the Year of Calc. */</span>
<a name="l00015"></a>00015 <span class="comment">/*          by  CALL sigrf(YEAR), CALL sdgrf(YEAR) or CALL spgrf(YEAR) .    */</span>
<a name="l00016"></a>00016 <span class="comment">/*      Then, CALL igrfc(FI, FK, H, F) gives TotalForce (F) of that model   */</span>
<a name="l00017"></a>00017 <span class="comment">/*          at the point of Lat.=FI, Long.=FK, Alt.=H                       */</span>
<a name="l00018"></a>00018 <span class="comment">/*      If other components are desired, CALL igrfm(FM) .                   */</span>
<a name="l00019"></a>00019 <span class="comment">/*          Here FM is an array with 6 elements, which correspond to        */</span>
<a name="l00020"></a>00020 <span class="comment">/*              North(X), East(Y), Downward(Z), Horizontal(H) components,   */</span>
<a name="l00021"></a>00021 <span class="comment">/*              Inclination(I) and Declination(D).                          */</span>
<a name="l00022"></a>00022 <span class="comment">/*  Unit Convention:  Lat.(FI), Long.(FK), Inc.(I), Dec.(D) are in degrees, */</span>
<a name="l00023"></a>00023 <span class="comment">/*                    Mag.Fields(F,X,Y,Z, H) in nT, and Alt.(H) in meters.   */</span>
<a name="l00024"></a>00024 <span class="comment">/****************************************************************************/</span>
<a name="l00025"></a>00025 <span class="comment">/* Prototype definition for C :                                             */</span>
<a name="l00026"></a>00026 <span class="comment">/*--------------------------------------------------------------------------*/</span>
<a name="l00027"></a>00027 <span class="comment">/*   &lt; Conventional Functions and their FORTRAN Interfaces &gt;                */</span>
<a name="l00028"></a>00028 <span class="comment">/*--------------------------------------------------------------------------*/</span>
<a name="l00029"></a>00029 <span class="comment">/*  void sigrf(double year);         |  void sigrf_(float *year);           */</span>
<a name="l00030"></a>00030 <span class="comment">/*   / void sdgrf(double year);      |   / void sdgrf_(float *year);        */</span>
<a name="l00031"></a>00031 <span class="comment">/*   / void spgrf(double year);      |   / void spgrf_(float *year);        */</span>
<a name="l00032"></a>00032 <span class="comment">/*  void gigrf(int gen, double year);|  void gigrf_(int *gen, float *year); */</span>
<a name="l00033"></a>00033 <span class="comment">/*  void igrfc(double fi, double fk, |  void igrfc_(float *fi, float *fk,   */</span>
<a name="l00034"></a>00034 <span class="comment">/*             double h, double *f); |              float *h, float *f);    */</span>
<a name="l00035"></a>00035 <span class="comment">/*  void igrfm(double fm[6]);        |  void igrfm_(float fm[6]);           */</span>
<a name="l00036"></a>00036 <span class="comment">/*--------------------------------------------------------------------------*/</span>
<a name="l00037"></a>00037 <span class="comment">/*   &lt; Substantial Calculation Functions &gt;                                  */</span>
<a name="l00038"></a>00038 <span class="comment">/*--------------------------------------------------------------------------*/</span>
<a name="l00039"></a>00039 <span class="comment">/*  void field(double are, double aflat, double ara, int maxoda);           */</span>
<a name="l00040"></a>00040 <span class="comment">/*  void tcoef(double agh[MxOD+1][MxOD+1], double aght[MxOD+1][MxOD+1],     */</span>
<a name="l00041"></a>00041 <span class="comment">/*             double atzero, int kexta, double aext[3]);                   */</span>
<a name="l00042"></a>00042 <span class="comment">/*  void tyear(double ayear);                                               */</span>
<a name="l00043"></a>00043 <span class="comment">/*  void mfldg(double alat, double alon, double ahi,                        */</span>
<a name="l00044"></a>00044 <span class="comment">/*             double *ax, double *ay, double *az, double *af);             */</span>
<a name="l00045"></a>00045 <span class="comment">/*  void mfldc(double athe, double alon, double ar,                         */</span>
<a name="l00046"></a>00046 <span class="comment">/*             double *ax, double *ay, double *az, double *af);             */</span>
<a name="l00047"></a>00047 <span class="comment">/*  void gcomp(double *axg, double *ayg, double *azg);                      */</span>
<a name="l00048"></a>00048 <span class="comment">/****************************************************************************/</span>
<a name="l00049"></a>00049 
<a name="l00050"></a>00050 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include &lt;cstdlib&gt;</span>
<a name="l00054"></a>00054 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00055"></a>00055 <span class="preprocessor">#include &quot;<a class="code" href="sgp4ext_8h.html" title="NJHILSから持ってきた軌道計算関係モジュールを，sgp4名前空間でラップして使用．">../sgp4/sgp4ext.h</a>&quot;</span>
<a name="l00056"></a>00056 <span class="keyword">using namespace </span>std;
<a name="l00057"></a>00057 <span class="keyword">using namespace </span><a class="code" href="namespacesgp4.html#adee1a80d66854d4af45c2a24df69a594">sgp4</a>;
<a name="l00058"></a>00058 <span class="preprocessor">#include &quot;<a class="code" href="igrf_8h.html" title="NJHILSから持ってきたIGRF計算モジュールを，igrf名前空間でラップして使用．">igrf.h</a>&quot;</span>
<a name="l00059"></a>00059 
<a name="l00060"></a><a class="code" href="namespaceigrf.html">00060</a> <span class="keyword">namespace </span>igrf {
<a name="l00061"></a>00061 
<a name="l00062"></a><a class="code" href="namespaceigrf.html#a53250eac53c1650b294f9ccdc8660dda">00062</a> <span class="keywordtype">double</span> <a class="code" href="namespaceigrf.html#a53250eac53c1650b294f9ccdc8660dda">testglobal</a>[3];
<a name="l00063"></a>00063 
<a name="l00064"></a>00064 <span class="preprocessor">#pragma warning( disable: 4996 )        //fopenなど回避</span>
<a name="l00065"></a>00065 <span class="preprocessor"></span><span class="preprocessor">#pragma warning( disable: 4305 )        //double-&gt;float回避</span>
<a name="l00066"></a>00066 <span class="preprocessor"></span>
<a name="l00067"></a>00067 <span class="comment">/*--------------------*/</span>
<a name="l00068"></a>00068 <span class="comment">/*   Basic Routines   */</span>
<a name="l00069"></a>00069 <span class="comment">/*--------------------*/</span>
<a name="l00070"></a>00070 
<a name="l00071"></a><a class="code" href="igrf_8cpp.html#ad3b555fe9b490cad87d08df74695d04e">00071</a> <span class="preprocessor">#define MxOD    19</span>
<a name="l00072"></a><a class="code" href="igrf_8cpp.html#a4cc6bb41fcf089fba3b57ace4750af7d">00072</a> <span class="preprocessor"></span><span class="preprocessor">#define URAD    (180./3.14159265359)</span>
<a name="l00073"></a>00073 <span class="preprocessor"></span>
<a name="l00074"></a><a class="code" href="igrf_8cpp.html#a598a3330b3c21701223ee0ca14316eca">00074</a> <span class="preprocessor">#define PI                      3.14159265358979323846</span>
<a name="l00075"></a><a class="code" href="igrf_8cpp.html#af7e8592d0a634bd3642e9fd508ea8022">00075</a> <span class="preprocessor"></span><span class="preprocessor">#define DEG2RAD         0.017453292519943295769236907684886     // PI/180</span>
<a name="l00076"></a><a class="code" href="igrf_8cpp.html#ac5a945020d3528355cda82d383676736">00076</a> <span class="preprocessor"></span><span class="preprocessor">#define RAD2DEG         (180/PI)</span>
<a name="l00077"></a>00077 <span class="preprocessor"></span>
<a name="l00078"></a>00078 
<a name="l00079"></a><a class="code" href="namespaceigrf.html#a01ec21ff7caa1eb8ab34cef76afdf079">00079</a> <span class="keyword">static</span> <span class="keywordtype">double</span> ra, <a class="code" href="namespaceigrf.html#a997978e67aabde0f6d9651d7e58b2c44">rpre</a>, <a class="code" href="namespaceigrf.html#ac127b47c1b8c796d7938c30033d7328c">re</a>, <a class="code" href="namespaceigrf.html#a2990be59fc31675482431fae7fc35519">re2</a>, <a class="code" href="namespaceigrf.html#a757a1e744aa750904f6b80e45d838708">re4</a>, <a class="code" href="namespaceigrf.html#a1670ea32cbb705b1f9dea16bd93019a3">rp</a>, <a class="code" href="namespaceigrf.html#aa2061b7eae80ebc074b5ed8f60d3919e">rp2</a>, <a class="code" href="namespaceigrf.html#ad7eba4813b793b2d4e2d5a436efb7e15">rp4</a>, <a class="code" href="namespaceigrf.html#a01ec21ff7caa1eb8ab34cef76afdf079">tzero</a>;
<a name="l00080"></a><a class="code" href="namespaceigrf.html#a251c0354fed8847aba0e599e189b6329">00080</a> <span class="keyword">static</span> <span class="keywordtype">int</span> maxod, <a class="code" href="namespaceigrf.html#a98b997aa944ff7d2e28b495e4dbd3198">kg</a>, <a class="code" href="namespaceigrf.html#a7800ea2a20171d0727c6a9aed2914464">kgc</a>, <a class="code" href="namespaceigrf.html#abb628cdea11983720d4d4b8b8b9170f6">kr</a>, <a class="code" href="namespaceigrf.html#a251c0354fed8847aba0e599e189b6329">kth</a>, <a class="code" href="namespaceigrf.html#a377d54136a069a1c52999537b8b72036">kph</a>, <a class="code" href="namespaceigrf.html#ac602791a64d9846feb68b1ff2245509b">kext</a>;
<a name="l00081"></a><a class="code" href="namespaceigrf.html#a3167337b67dd9008771f04a48981d248">00081</a> <span class="keyword">static</span> <span class="keywordtype">double</span> blat, <a class="code" href="namespaceigrf.html#a0f1c87af4abbeb720d98948cb163d695">blon</a>, <a class="code" href="namespaceigrf.html#a0fa34d91e318104a17d00ecb9277f4f9">bhi</a>, <a class="code" href="namespaceigrf.html#a7a44fcd829906b1b654b13a8b6678038">br</a>, <a class="code" href="namespaceigrf.html#a3167337b67dd9008771f04a48981d248">bthe</a>, <a class="code" href="namespaceigrf.html#abceffa4a56520c69b74fa4400992ec67">bthc</a>;
<a name="l00082"></a><a class="code" href="namespaceigrf.html#a14156b9ee1bb26e2e6b69044674a774b">00082</a> <span class="keyword">static</span> <span class="keywordtype">double</span> rlat, <a class="code" href="namespaceigrf.html#a4f07b29495fc706357f14a3757fe4d9b">slat</a>, <a class="code" href="namespaceigrf.html#a14156b9ee1bb26e2e6b69044674a774b">slat2</a>, <a class="code" href="namespaceigrf.html#ac6f5f35bd8a92a659ac6d9e015d963a8">clat</a>, <a class="code" href="namespaceigrf.html#a5ebdb0cbbff684edd115261744b9b31e">clat2</a>;
<a name="l00083"></a><a class="code" href="namespaceigrf.html#a5fa53562f8a37ba64d5f6cb1e82c5e3e">00083</a> <span class="keyword">static</span> <span class="keywordtype">double</span> r, <a class="code" href="namespaceigrf.html#a5fa53562f8a37ba64d5f6cb1e82c5e3e">the</a>, <a class="code" href="namespaceigrf.html#ae1c3cea569b6dc64778870fe439ef072">phi</a>, <a class="code" href="namespaceigrf.html#ae49465fde6b2fbd446b9992e3d296ff8">cth</a>, <a class="code" href="namespaceigrf.html#a8322c257f5cc921ae48b856b18ef9d68">sth</a>, <a class="code" href="namespaceigrf.html#a26df0bd4407dade228ff3654701c47c0">cph</a>, <a class="code" href="namespaceigrf.html#af50f2b53f95f4798c1ed26cf8b2465cb">sph</a>;
<a name="l00084"></a><a class="code" href="namespaceigrf.html#a331e204532a196349922b6ceb77bfd26">00084</a> <span class="keyword">static</span> <span class="keywordtype">double</span> x, <a class="code" href="namespaceigrf.html#aef378991c40e0acdd01f61c2ef7d3976">y</a>, <a class="code" href="namespaceigrf.html#a331e204532a196349922b6ceb77bfd26">z</a>, <a class="code" href="namespaceigrf.html#a804225ad2942311ba664c4a09e5cd887">f</a>, <a class="code" href="namespaceigrf.html#ac3e6eb375626124ddd8e7d0cb7c2d252">ext0</a>, <a class="code" href="namespaceigrf.html#a21845dfa4854afef61a31b0782c69fab">ext1</a>, <a class="code" href="namespaceigrf.html#a845611906637950776f1b0656755648c">ext2</a>;
<a name="l00085"></a><a class="code" href="namespaceigrf.html#a4368a23aaf3876b23297cb21ca2c9e03">00085</a> <span class="keyword">static</span> <span class="keywordtype">double</span> gh[<a class="code" href="igrf_8cpp.html#ad3b555fe9b490cad87d08df74695d04e">MxOD</a>+1][<a class="code" href="igrf_8cpp.html#ad3b555fe9b490cad87d08df74695d04e">MxOD</a>+1], <a class="code" href="namespaceigrf.html#a4368a23aaf3876b23297cb21ca2c9e03">ght</a>[<a class="code" href="igrf_8cpp.html#ad3b555fe9b490cad87d08df74695d04e">MxOD</a>+1][<a class="code" href="igrf_8cpp.html#ad3b555fe9b490cad87d08df74695d04e">MxOD</a>+1], <a class="code" href="namespaceigrf.html#a5cc21ef2e659fedb4bc2c4a83e786b6f">g</a>[<a class="code" href="igrf_8cpp.html#ad3b555fe9b490cad87d08df74695d04e">MxOD</a>+1][<a class="code" href="igrf_8cpp.html#ad3b555fe9b490cad87d08df74695d04e">MxOD</a>+1];
<a name="l00086"></a><a class="code" href="namespaceigrf.html#af72af0f4c83ef96888323ef503ff5023">00086</a> <span class="keyword">static</span> <span class="keywordtype">double</span> rar[<a class="code" href="igrf_8cpp.html#ad3b555fe9b490cad87d08df74695d04e">MxOD</a>+1], <a class="code" href="namespaceigrf.html#a0e33600a0d26db0872c81849ca524d72">csp</a>[<a class="code" href="igrf_8cpp.html#ad3b555fe9b490cad87d08df74695d04e">MxOD</a>+1], <a class="code" href="namespaceigrf.html#af72af0f4c83ef96888323ef503ff5023">snp</a>[<a class="code" href="igrf_8cpp.html#ad3b555fe9b490cad87d08df74695d04e">MxOD</a>+1], <a class="code" href="namespaceigrf.html#a9b0d3a2208a4bd2bf3982ee85d905d5a">p</a>[<a class="code" href="igrf_8cpp.html#ad3b555fe9b490cad87d08df74695d04e">MxOD</a>+2][<a class="code" href="igrf_8cpp.html#ad3b555fe9b490cad87d08df74695d04e">MxOD</a>+1];
<a name="l00087"></a>00087 
<a name="l00088"></a><a class="code" href="namespaceigrf.html#aa95a5325587e6e46b60fdfbc45bccb36">00088</a> <span class="keyword">static</span> <span class="keywordtype">double</span> vgh[<a class="code" href="igrf_8cpp.html#ad3b555fe9b490cad87d08df74695d04e">MxOD</a>+1][<a class="code" href="igrf_8cpp.html#ad3b555fe9b490cad87d08df74695d04e">MxOD</a>+1], <a class="code" href="namespaceigrf.html#aa95a5325587e6e46b60fdfbc45bccb36">vght</a>[<a class="code" href="igrf_8cpp.html#ad3b555fe9b490cad87d08df74695d04e">MxOD</a>+1][<a class="code" href="igrf_8cpp.html#ad3b555fe9b490cad87d08df74695d04e">MxOD</a>+1];
<a name="l00089"></a>00089 
<a name="l00090"></a>00090 <span class="keyword">static</span> <span class="keywordtype">void</span> fcalc(<span class="keywordtype">void</span>)     <span class="comment">/* This is an internal function */</span>
<a name="l00091"></a>00091 {   <span class="keywordtype">double</span> t, pn1m, tx, ty, tz; <span class="keywordtype">int</span> n, m;
<a name="l00092"></a>00092     <span class="keywordflow">if</span> (<a class="code" href="namespaceigrf.html#abb628cdea11983720d4d4b8b8b9170f6">kr</a> != 0) {
<a name="l00093"></a>00093         <a class="code" href="namespaceigrf.html#abb628cdea11983720d4d4b8b8b9170f6">kr</a>=0; t=ra/r; rar[0]=t*t;
<a name="l00094"></a>00094         <span class="keywordflow">for</span> (n=0; n&lt;maxod; n++) rar[n+1]=rar[n]*t;
<a name="l00095"></a>00095     }
<a name="l00096"></a>00096     <span class="keywordflow">if</span> (<a class="code" href="namespaceigrf.html#a251c0354fed8847aba0e599e189b6329">kth</a> != 0) {
<a name="l00097"></a>00097         <a class="code" href="namespaceigrf.html#a251c0354fed8847aba0e599e189b6329">kth</a>=0; <a class="code" href="namespaceigrf.html#a9b0d3a2208a4bd2bf3982ee85d905d5a">p</a>[0][0]=1.; <a class="code" href="namespaceigrf.html#a9b0d3a2208a4bd2bf3982ee85d905d5a">p</a>[1][0]=0.;
<a name="l00098"></a>00098         <a class="code" href="namespaceigrf.html#a9b0d3a2208a4bd2bf3982ee85d905d5a">p</a>[0][1]=<a class="code" href="namespaceigrf.html#ae49465fde6b2fbd446b9992e3d296ff8">cth</a>; <a class="code" href="namespaceigrf.html#a9b0d3a2208a4bd2bf3982ee85d905d5a">p</a>[1][1]=<a class="code" href="namespaceigrf.html#a8322c257f5cc921ae48b856b18ef9d68">sth</a>; <a class="code" href="namespaceigrf.html#a9b0d3a2208a4bd2bf3982ee85d905d5a">p</a>[2][0]=-<a class="code" href="namespaceigrf.html#a8322c257f5cc921ae48b856b18ef9d68">sth</a>; <a class="code" href="namespaceigrf.html#a9b0d3a2208a4bd2bf3982ee85d905d5a">p</a>[2][1]=<a class="code" href="namespaceigrf.html#ae49465fde6b2fbd446b9992e3d296ff8">cth</a>;
<a name="l00099"></a>00099         <span class="keywordflow">for</span> (n=1; n&lt;maxod; n++) {
<a name="l00100"></a>00100             <a class="code" href="namespaceigrf.html#a9b0d3a2208a4bd2bf3982ee85d905d5a">p</a>[0][n+1]=(<a class="code" href="namespaceigrf.html#a9b0d3a2208a4bd2bf3982ee85d905d5a">p</a>[0][n]*<a class="code" href="namespaceigrf.html#ae49465fde6b2fbd446b9992e3d296ff8">cth</a>*(n+n+1)-<a class="code" href="namespaceigrf.html#a9b0d3a2208a4bd2bf3982ee85d905d5a">p</a>[0][n-1]*n)/(n+1);
<a name="l00101"></a>00101             <a class="code" href="namespaceigrf.html#a9b0d3a2208a4bd2bf3982ee85d905d5a">p</a>[n+2][0]=(<a class="code" href="namespaceigrf.html#a9b0d3a2208a4bd2bf3982ee85d905d5a">p</a>[0][n+1]*<a class="code" href="namespaceigrf.html#ae49465fde6b2fbd446b9992e3d296ff8">cth</a>-<a class="code" href="namespaceigrf.html#a9b0d3a2208a4bd2bf3982ee85d905d5a">p</a>[0][n])*(n+1)/<a class="code" href="namespaceigrf.html#a8322c257f5cc921ae48b856b18ef9d68">sth</a>;
<a name="l00102"></a>00102             <span class="keywordflow">for</span> (m=0; m&lt;=n; m++) {
<a name="l00103"></a>00103                 pn1m=<a class="code" href="namespaceigrf.html#a9b0d3a2208a4bd2bf3982ee85d905d5a">p</a>[m][n+1];
<a name="l00104"></a>00104                 <a class="code" href="namespaceigrf.html#a9b0d3a2208a4bd2bf3982ee85d905d5a">p</a>[m+1][n+1]=(<a class="code" href="namespaceigrf.html#a9b0d3a2208a4bd2bf3982ee85d905d5a">p</a>[m][n]*(n+m+1)-pn1m*<a class="code" href="namespaceigrf.html#ae49465fde6b2fbd446b9992e3d296ff8">cth</a>*(n-m+1))/<a class="code" href="namespaceigrf.html#a8322c257f5cc921ae48b856b18ef9d68">sth</a>;
<a name="l00105"></a>00105                 <a class="code" href="namespaceigrf.html#a9b0d3a2208a4bd2bf3982ee85d905d5a">p</a>[n+2][m+1]=pn1m*(n+m+2)*(n-m+1)-<a class="code" href="namespaceigrf.html#a9b0d3a2208a4bd2bf3982ee85d905d5a">p</a>[m+1][n+1]*<a class="code" href="namespaceigrf.html#ae49465fde6b2fbd446b9992e3d296ff8">cth</a>*(m+1)/<a class="code" href="namespaceigrf.html#a8322c257f5cc921ae48b856b18ef9d68">sth</a>;
<a name="l00106"></a>00106             }
<a name="l00107"></a>00107         }
<a name="l00108"></a>00108     }
<a name="l00109"></a>00109     <span class="keywordflow">if</span> (<a class="code" href="namespaceigrf.html#a377d54136a069a1c52999537b8b72036">kph</a> != 0) {
<a name="l00110"></a>00110         <a class="code" href="namespaceigrf.html#a377d54136a069a1c52999537b8b72036">kph</a>=0; <a class="code" href="namespaceigrf.html#a0e33600a0d26db0872c81849ca524d72">csp</a>[0]=1.; <a class="code" href="namespaceigrf.html#af72af0f4c83ef96888323ef503ff5023">snp</a>[0]=0.;
<a name="l00111"></a>00111         <span class="keywordflow">for</span> (m=0; m&lt;maxod; m++) {
<a name="l00112"></a>00112             <a class="code" href="namespaceigrf.html#a0e33600a0d26db0872c81849ca524d72">csp</a>[m+1]=<a class="code" href="namespaceigrf.html#a0e33600a0d26db0872c81849ca524d72">csp</a>[m]*<a class="code" href="namespaceigrf.html#a26df0bd4407dade228ff3654701c47c0">cph</a>-<a class="code" href="namespaceigrf.html#af72af0f4c83ef96888323ef503ff5023">snp</a>[m]*<a class="code" href="namespaceigrf.html#af50f2b53f95f4798c1ed26cf8b2465cb">sph</a>;
<a name="l00113"></a>00113             <a class="code" href="namespaceigrf.html#af72af0f4c83ef96888323ef503ff5023">snp</a>[m+1]=<a class="code" href="namespaceigrf.html#af72af0f4c83ef96888323ef503ff5023">snp</a>[m]*<a class="code" href="namespaceigrf.html#a26df0bd4407dade228ff3654701c47c0">cph</a>+<a class="code" href="namespaceigrf.html#a0e33600a0d26db0872c81849ca524d72">csp</a>[m]*<a class="code" href="namespaceigrf.html#af50f2b53f95f4798c1ed26cf8b2465cb">sph</a>;
<a name="l00114"></a>00114         }
<a name="l00115"></a>00115     }
<a name="l00116"></a>00116     x=0.; <a class="code" href="namespaceigrf.html#aef378991c40e0acdd01f61c2ef7d3976">y</a>=0.; <a class="code" href="namespaceigrf.html#a331e204532a196349922b6ceb77bfd26">z</a>=0.;
<a name="l00117"></a>00117     <span class="keywordflow">for</span> (n=0; n&lt;maxod; n++) {
<a name="l00118"></a>00118         tx=<a class="code" href="namespaceigrf.html#a5cc21ef2e659fedb4bc2c4a83e786b6f">g</a>[0][n+1]*<a class="code" href="namespaceigrf.html#a9b0d3a2208a4bd2bf3982ee85d905d5a">p</a>[n+2][0]; ty=0.; tz=<a class="code" href="namespaceigrf.html#a5cc21ef2e659fedb4bc2c4a83e786b6f">g</a>[0][n+1]*p[0][n+1];
<a name="l00119"></a>00119         <span class="keywordflow">for</span> (m=0; m&lt;=n; m++) {
<a name="l00120"></a>00120             tx+=(<a class="code" href="namespaceigrf.html#a5cc21ef2e659fedb4bc2c4a83e786b6f">g</a>[m+1][n+1]*<a class="code" href="namespaceigrf.html#a0e33600a0d26db0872c81849ca524d72">csp</a>[m+1]+<a class="code" href="namespaceigrf.html#a5cc21ef2e659fedb4bc2c4a83e786b6f">g</a>[n+1][m]*<a class="code" href="namespaceigrf.html#af72af0f4c83ef96888323ef503ff5023">snp</a>[m+1])*p[n+2][m+1];
<a name="l00121"></a>00121             ty+=(<a class="code" href="namespaceigrf.html#a5cc21ef2e659fedb4bc2c4a83e786b6f">g</a>[m+1][n+1]*<a class="code" href="namespaceigrf.html#af72af0f4c83ef96888323ef503ff5023">snp</a>[m+1]-<a class="code" href="namespaceigrf.html#a5cc21ef2e659fedb4bc2c4a83e786b6f">g</a>[n+1][m]*<a class="code" href="namespaceigrf.html#a0e33600a0d26db0872c81849ca524d72">csp</a>[m+1])*p[m+1][n+1]*(m+1);
<a name="l00122"></a>00122             tz+=(<a class="code" href="namespaceigrf.html#a5cc21ef2e659fedb4bc2c4a83e786b6f">g</a>[m+1][n+1]*<a class="code" href="namespaceigrf.html#a0e33600a0d26db0872c81849ca524d72">csp</a>[m+1]+<a class="code" href="namespaceigrf.html#a5cc21ef2e659fedb4bc2c4a83e786b6f">g</a>[n+1][m]*<a class="code" href="namespaceigrf.html#af72af0f4c83ef96888323ef503ff5023">snp</a>[m+1])*p[m+1][n+1];
<a name="l00123"></a>00123         }
<a name="l00124"></a>00124         x+=rar[n+1]*tx; <a class="code" href="namespaceigrf.html#aef378991c40e0acdd01f61c2ef7d3976">y</a>+=rar[n+1]*ty; <a class="code" href="namespaceigrf.html#a331e204532a196349922b6ceb77bfd26">z</a>-=rar[n+1]*tz*(n+2);
<a name="l00125"></a>00125     }
<a name="l00126"></a>00126     <a class="code" href="namespaceigrf.html#aef378991c40e0acdd01f61c2ef7d3976">y</a>/=<a class="code" href="namespaceigrf.html#a8322c257f5cc921ae48b856b18ef9d68">sth</a>;
<a name="l00127"></a>00127     <span class="keywordflow">if</span> (<a class="code" href="namespaceigrf.html#ac602791a64d9846feb68b1ff2245509b">kext</a> != 0) {
<a name="l00128"></a>00128         t=<a class="code" href="namespaceigrf.html#a21845dfa4854afef61a31b0782c69fab">ext1</a>*<a class="code" href="namespaceigrf.html#a26df0bd4407dade228ff3654701c47c0">cph</a>+<a class="code" href="namespaceigrf.html#a845611906637950776f1b0656755648c">ext2</a>*<a class="code" href="namespaceigrf.html#af50f2b53f95f4798c1ed26cf8b2465cb">sph</a>; x-=(<a class="code" href="namespaceigrf.html#ac3e6eb375626124ddd8e7d0cb7c2d252">ext0</a>*<a class="code" href="namespaceigrf.html#ae49465fde6b2fbd446b9992e3d296ff8">cth</a>+t*<a class="code" href="namespaceigrf.html#a8322c257f5cc921ae48b856b18ef9d68">sth</a>);
<a name="l00129"></a>00129         <a class="code" href="namespaceigrf.html#aef378991c40e0acdd01f61c2ef7d3976">y</a>+=(<a class="code" href="namespaceigrf.html#a21845dfa4854afef61a31b0782c69fab">ext1</a>*sph-<a class="code" href="namespaceigrf.html#a845611906637950776f1b0656755648c">ext2</a>*<a class="code" href="namespaceigrf.html#a26df0bd4407dade228ff3654701c47c0">cph</a>); <a class="code" href="namespaceigrf.html#a331e204532a196349922b6ceb77bfd26">z</a>+=(<a class="code" href="namespaceigrf.html#ac3e6eb375626124ddd8e7d0cb7c2d252">ext0</a>*<a class="code" href="namespaceigrf.html#a8322c257f5cc921ae48b856b18ef9d68">sth</a>-t*<a class="code" href="namespaceigrf.html#ae49465fde6b2fbd446b9992e3d296ff8">cth</a>);
<a name="l00130"></a>00130     }
<a name="l00131"></a>00131     <a class="code" href="namespaceigrf.html#a804225ad2942311ba664c4a09e5cd887">f</a>=<a class="code" href="namespacestf_1_1util_1_1math.html#aaeb9c85b00f8c1afc33f9009e902e0d4" title="平方根を求める，cmathのラッパ．">sqrt</a>(x*x+<a class="code" href="namespaceigrf.html#aef378991c40e0acdd01f61c2ef7d3976">y</a>*<a class="code" href="namespaceigrf.html#aef378991c40e0acdd01f61c2ef7d3976">y</a>+<a class="code" href="namespaceigrf.html#a331e204532a196349922b6ceb77bfd26">z</a>*<a class="code" href="namespaceigrf.html#a331e204532a196349922b6ceb77bfd26">z</a>);
<a name="l00132"></a>00132 }
<a name="l00133"></a>00133 
<a name="l00134"></a><a class="code" href="namespaceigrf.html#af39a8523c9c204bca69a99dda2956b6c">00134</a> <span class="keywordtype">void</span> <a class="code" href="namespaceigrf.html#af39a8523c9c204bca69a99dda2956b6c">field</a>(<span class="keywordtype">double</span> are, <span class="keywordtype">double</span> aflat, <span class="keywordtype">double</span> ara, <span class="keywordtype">int</span> maxoda)
<a name="l00135"></a>00135 {   ra=ara; maxod=maxoda; <a class="code" href="namespaceigrf.html#a997978e67aabde0f6d9651d7e58b2c44">rpre</a>=1.-1./aflat;
<a name="l00136"></a>00136     <a class="code" href="namespaceigrf.html#ac127b47c1b8c796d7938c30033d7328c">re</a>=are; <a class="code" href="namespaceigrf.html#a2990be59fc31675482431fae7fc35519">re2</a>=<a class="code" href="namespaceigrf.html#ac127b47c1b8c796d7938c30033d7328c">re</a>*<a class="code" href="namespaceigrf.html#ac127b47c1b8c796d7938c30033d7328c">re</a>; <a class="code" href="namespaceigrf.html#a757a1e744aa750904f6b80e45d838708">re4</a>=<a class="code" href="namespaceigrf.html#a2990be59fc31675482431fae7fc35519">re2</a>*<a class="code" href="namespaceigrf.html#a2990be59fc31675482431fae7fc35519">re2</a>; <a class="code" href="namespaceigrf.html#a1670ea32cbb705b1f9dea16bd93019a3">rp</a>=re*<a class="code" href="namespaceigrf.html#a997978e67aabde0f6d9651d7e58b2c44">rpre</a>; <a class="code" href="namespaceigrf.html#aa2061b7eae80ebc074b5ed8f60d3919e">rp2</a>=<a class="code" href="namespaceigrf.html#a1670ea32cbb705b1f9dea16bd93019a3">rp</a>*<a class="code" href="namespaceigrf.html#a1670ea32cbb705b1f9dea16bd93019a3">rp</a>; <a class="code" href="namespaceigrf.html#ad7eba4813b793b2d4e2d5a436efb7e15">rp4</a>=<a class="code" href="namespaceigrf.html#aa2061b7eae80ebc074b5ed8f60d3919e">rp2</a>*<a class="code" href="namespaceigrf.html#aa2061b7eae80ebc074b5ed8f60d3919e">rp2</a>;
<a name="l00137"></a>00137     <a class="code" href="namespaceigrf.html#a98b997aa944ff7d2e28b495e4dbd3198">kg</a>=2; <a class="code" href="namespaceigrf.html#a7800ea2a20171d0727c6a9aed2914464">kgc</a>=0; <a class="code" href="namespaceigrf.html#a377d54136a069a1c52999537b8b72036">kph</a>=1;
<a name="l00138"></a>00138 }
<a name="l00139"></a>00139 
<a name="l00140"></a><a class="code" href="namespaceigrf.html#a61593015602f60e05150b6d883268b41">00140</a> <span class="keywordtype">void</span> <a class="code" href="namespaceigrf.html#a61593015602f60e05150b6d883268b41">tcoef</a>(<span class="keywordtype">double</span> agh[<a class="code" href="igrf_8cpp.html#ad3b555fe9b490cad87d08df74695d04e">MxOD</a>+1][<a class="code" href="igrf_8cpp.html#ad3b555fe9b490cad87d08df74695d04e">MxOD</a>+1], <span class="keywordtype">double</span> aght[<a class="code" href="igrf_8cpp.html#ad3b555fe9b490cad87d08df74695d04e">MxOD</a>+1][<a class="code" href="igrf_8cpp.html#ad3b555fe9b490cad87d08df74695d04e">MxOD</a>+1],
<a name="l00141"></a>00141             <span class="keywordtype">double</span> atzero, <span class="keywordtype">int</span> kexta, <span class="keywordtype">double</span> aext[3])
<a name="l00142"></a>00142 {   <span class="keywordtype">int</span> nn, mm; <span class="keywordtype">double</span> fac;
<a name="l00143"></a>00143     <a class="code" href="namespaceigrf.html#a01ec21ff7caa1eb8ab34cef76afdf079">tzero</a>=atzero; <a class="code" href="namespaceigrf.html#ac602791a64d9846feb68b1ff2245509b">kext</a>=kexta; gh[0][0]=0.; <a class="code" href="namespaceigrf.html#a4368a23aaf3876b23297cb21ca2c9e03">ght</a>[0][0]=0.;
<a name="l00144"></a>00144     <span class="keywordflow">for</span> (nn=1; nn&lt;=maxod; nn++) {
<a name="l00145"></a>00145         gh[0][nn]=agh[0][nn]; <a class="code" href="namespaceigrf.html#a4368a23aaf3876b23297cb21ca2c9e03">ght</a>[0][nn]=aght[0][nn]; fac=<a class="code" href="namespacestf_1_1util_1_1math.html#aaeb9c85b00f8c1afc33f9009e902e0d4" title="平方根を求める，cmathのラッパ．">sqrt</a>(2.);
<a name="l00146"></a>00146         <span class="keywordflow">for</span> (mm=1; mm&lt;=nn; mm++) {
<a name="l00147"></a>00147             fac/=<a class="code" href="namespacestf_1_1util_1_1math.html#aaeb9c85b00f8c1afc33f9009e902e0d4" title="平方根を求める，cmathのラッパ．">sqrt</a>((<span class="keywordtype">double</span>)((nn+mm)*(nn-mm+1)));
<a name="l00148"></a>00148             gh[mm][nn]=agh[mm][nn]*fac; gh[nn][mm-1]=agh[nn][mm-1]*fac;
<a name="l00149"></a>00149             <a class="code" href="namespaceigrf.html#a4368a23aaf3876b23297cb21ca2c9e03">ght</a>[mm][nn]=aght[mm][nn]*fac; <a class="code" href="namespaceigrf.html#a4368a23aaf3876b23297cb21ca2c9e03">ght</a>[nn][mm-1]=aght[nn][mm-1]*fac;
<a name="l00150"></a>00150         }
<a name="l00151"></a>00151     }
<a name="l00152"></a>00152     <span class="keywordflow">if</span> (<a class="code" href="namespaceigrf.html#ac602791a64d9846feb68b1ff2245509b">kext</a> == 0) { <a class="code" href="namespaceigrf.html#ac3e6eb375626124ddd8e7d0cb7c2d252">ext0</a>=0.; <a class="code" href="namespaceigrf.html#a21845dfa4854afef61a31b0782c69fab">ext1</a>=0.; <a class="code" href="namespaceigrf.html#a845611906637950776f1b0656755648c">ext2</a>=0.; }
<a name="l00153"></a>00153     <span class="keywordflow">else</span> { <a class="code" href="namespaceigrf.html#ac3e6eb375626124ddd8e7d0cb7c2d252">ext0</a>=aext[0]; <a class="code" href="namespaceigrf.html#a21845dfa4854afef61a31b0782c69fab">ext1</a>=aext[1]; <a class="code" href="namespaceigrf.html#a845611906637950776f1b0656755648c">ext2</a>=aext[2]; }
<a name="l00154"></a>00154 }
<a name="l00155"></a>00155 
<a name="l00156"></a><a class="code" href="namespaceigrf.html#a5bb32a15af56d15180a5353a06be99d9">00156</a> <span class="keywordtype">void</span> <a class="code" href="namespaceigrf.html#a5bb32a15af56d15180a5353a06be99d9">tyear</a>(<span class="keywordtype">double</span> ayear)
<a name="l00157"></a>00157 {   <span class="keywordtype">double</span> dyear; <span class="keywordtype">int</span> nn, mm;
<a name="l00158"></a>00158     dyear=ayear-<a class="code" href="namespaceigrf.html#a01ec21ff7caa1eb8ab34cef76afdf079">tzero</a>;
<a name="l00159"></a>00159     <span class="keywordflow">for</span> (nn=0; nn&lt;=maxod; nn++) {
<a name="l00160"></a>00160         <span class="keywordflow">for</span> (mm=0; mm&lt;=maxod; mm++) {
<a name="l00161"></a>00161             <a class="code" href="namespaceigrf.html#a5cc21ef2e659fedb4bc2c4a83e786b6f">g</a>[mm][nn]=gh[mm][nn]+<a class="code" href="namespaceigrf.html#a4368a23aaf3876b23297cb21ca2c9e03">ght</a>[mm][nn]*dyear;
<a name="l00162"></a>00162         }
<a name="l00163"></a>00163     }
<a name="l00164"></a>00164 }
<a name="l00165"></a>00165 
<a name="l00166"></a><a class="code" href="namespaceigrf.html#aeece8916124afaf31017aab0755c78f0">00166</a> <span class="keywordtype">void</span> <a class="code" href="namespaceigrf.html#aeece8916124afaf31017aab0755c78f0">mfldg</a>(<span class="keywordtype">double</span> alat, <span class="keywordtype">double</span> alon, <span class="keywordtype">double</span> ahi,
<a name="l00167"></a>00167             <span class="keywordtype">double</span> *ax, <span class="keywordtype">double</span> *ay, <span class="keywordtype">double</span> *az, <span class="keywordtype">double</span> *af)
<a name="l00168"></a>00168 {   <span class="keywordtype">double</span> hi, rm2, rm, rrm;
<a name="l00169"></a>00169     <span class="keywordflow">if</span> ((<a class="code" href="namespaceigrf.html#a98b997aa944ff7d2e28b495e4dbd3198">kg</a>!=1) || (blat!=alat) || (<a class="code" href="namespaceigrf.html#a0fa34d91e318104a17d00ecb9277f4f9">bhi</a>!=ahi)) {
<a name="l00170"></a>00170         <a class="code" href="namespaceigrf.html#a98b997aa944ff7d2e28b495e4dbd3198">kg</a>=1; <a class="code" href="namespaceigrf.html#abb628cdea11983720d4d4b8b8b9170f6">kr</a>=1; <a class="code" href="namespaceigrf.html#a251c0354fed8847aba0e599e189b6329">kth</a>=1; blat=alat; <a class="code" href="namespaceigrf.html#a0fa34d91e318104a17d00ecb9277f4f9">bhi</a>=ahi;
<a name="l00171"></a>00171         rlat=alat/<a class="code" href="igrf_8cpp.html#a4cc6bb41fcf089fba3b57ace4750af7d">URAD</a>; hi=ahi; <a class="code" href="namespaceigrf.html#a4f07b29495fc706357f14a3757fe4d9b">slat</a>=sin(rlat); <a class="code" href="namespaceigrf.html#a14156b9ee1bb26e2e6b69044674a774b">slat2</a>=<a class="code" href="namespaceigrf.html#a4f07b29495fc706357f14a3757fe4d9b">slat</a>*<a class="code" href="namespaceigrf.html#a4f07b29495fc706357f14a3757fe4d9b">slat</a>;
<a name="l00172"></a>00172         <a class="code" href="namespaceigrf.html#a5ebdb0cbbff684edd115261744b9b31e">clat2</a>=1.-<a class="code" href="namespaceigrf.html#a14156b9ee1bb26e2e6b69044674a774b">slat2</a>; rm2=<a class="code" href="namespaceigrf.html#a2990be59fc31675482431fae7fc35519">re2</a>*<a class="code" href="namespaceigrf.html#a5ebdb0cbbff684edd115261744b9b31e">clat2</a>+<a class="code" href="namespaceigrf.html#aa2061b7eae80ebc074b5ed8f60d3919e">rp2</a>*<a class="code" href="namespaceigrf.html#a14156b9ee1bb26e2e6b69044674a774b">slat2</a>; rm=<a class="code" href="namespacestf_1_1util_1_1math.html#aaeb9c85b00f8c1afc33f9009e902e0d4" title="平方根を求める，cmathのラッパ．">sqrt</a>(rm2);
<a name="l00173"></a>00173         rrm=(<a class="code" href="namespaceigrf.html#a757a1e744aa750904f6b80e45d838708">re4</a>*<a class="code" href="namespaceigrf.html#a5ebdb0cbbff684edd115261744b9b31e">clat2</a>+<a class="code" href="namespaceigrf.html#ad7eba4813b793b2d4e2d5a436efb7e15">rp4</a>*<a class="code" href="namespaceigrf.html#a14156b9ee1bb26e2e6b69044674a774b">slat2</a>)/rm2; r=<a class="code" href="namespacestf_1_1util_1_1math.html#aaeb9c85b00f8c1afc33f9009e902e0d4" title="平方根を求める，cmathのラッパ．">sqrt</a>(rrm+2.*hi*rm+hi*hi);
<a name="l00174"></a>00174         <a class="code" href="namespaceigrf.html#ae49465fde6b2fbd446b9992e3d296ff8">cth</a>=slat*(hi+<a class="code" href="namespaceigrf.html#aa2061b7eae80ebc074b5ed8f60d3919e">rp2</a>/rm)/r; <a class="code" href="namespaceigrf.html#a8322c257f5cc921ae48b856b18ef9d68">sth</a>=<a class="code" href="namespacestf_1_1util_1_1math.html#aaeb9c85b00f8c1afc33f9009e902e0d4" title="平方根を求める，cmathのラッパ．">sqrt</a>(1.-<a class="code" href="namespaceigrf.html#ae49465fde6b2fbd446b9992e3d296ff8">cth</a>*<a class="code" href="namespaceigrf.html#ae49465fde6b2fbd446b9992e3d296ff8">cth</a>);
<a name="l00175"></a>00175     }
<a name="l00176"></a>00176     <span class="keywordflow">if</span> (<a class="code" href="namespaceigrf.html#a0f1c87af4abbeb720d98948cb163d695">blon</a> != alon) <a class="code" href="namespaceigrf.html#a377d54136a069a1c52999537b8b72036">kph</a>=1;
<a name="l00177"></a>00177     <span class="keywordflow">if</span> (<a class="code" href="namespaceigrf.html#a377d54136a069a1c52999537b8b72036">kph</a> != 0) { <a class="code" href="namespaceigrf.html#a0f1c87af4abbeb720d98948cb163d695">blon</a>=alon; <a class="code" href="namespaceigrf.html#ae1c3cea569b6dc64778870fe439ef072">phi</a>=alon/<a class="code" href="igrf_8cpp.html#a4cc6bb41fcf089fba3b57ace4750af7d">URAD</a>; <a class="code" href="namespaceigrf.html#a26df0bd4407dade228ff3654701c47c0">cph</a>=cos(<a class="code" href="namespaceigrf.html#ae1c3cea569b6dc64778870fe439ef072">phi</a>); <a class="code" href="namespaceigrf.html#af50f2b53f95f4798c1ed26cf8b2465cb">sph</a>=sin(<a class="code" href="namespaceigrf.html#ae1c3cea569b6dc64778870fe439ef072">phi</a>); }
<a name="l00178"></a>00178     fcalc(); *ax=x; *ay=<a class="code" href="namespaceigrf.html#aef378991c40e0acdd01f61c2ef7d3976">y</a>; *az=<a class="code" href="namespaceigrf.html#a331e204532a196349922b6ceb77bfd26">z</a>; *af=<a class="code" href="namespaceigrf.html#a804225ad2942311ba664c4a09e5cd887">f</a>;
<a name="l00179"></a>00179 }
<a name="l00180"></a>00180 
<a name="l00181"></a><a class="code" href="namespaceigrf.html#a3f4117af98c9d817152ac207813edfcd">00181</a> <span class="keywordtype">void</span> <a class="code" href="namespaceigrf.html#a3f4117af98c9d817152ac207813edfcd">mfldc</a>(<span class="keywordtype">double</span> athe, <span class="keywordtype">double</span> alon, <span class="keywordtype">double</span> ar,
<a name="l00182"></a>00182             <span class="keywordtype">double</span> *ax, <span class="keywordtype">double</span> *ay, <span class="keywordtype">double</span> *az, <span class="keywordtype">double</span> *af)
<a name="l00183"></a>00183 {   <span class="keywordflow">if</span> (<a class="code" href="namespaceigrf.html#a98b997aa944ff7d2e28b495e4dbd3198">kg</a> == 0) {
<a name="l00184"></a>00184         <span class="keywordflow">if</span> (<a class="code" href="namespaceigrf.html#a3167337b67dd9008771f04a48981d248">bthe</a> != athe) <a class="code" href="namespaceigrf.html#a251c0354fed8847aba0e599e189b6329">kth</a>=1;
<a name="l00185"></a>00185         <span class="keywordflow">if</span> (<a class="code" href="namespaceigrf.html#a7a44fcd829906b1b654b13a8b6678038">br</a> != ar) <a class="code" href="namespaceigrf.html#abb628cdea11983720d4d4b8b8b9170f6">kr</a>=1;
<a name="l00186"></a>00186     }
<a name="l00187"></a>00187     <span class="keywordflow">else</span> { <a class="code" href="namespaceigrf.html#a98b997aa944ff7d2e28b495e4dbd3198">kg</a>=0; <a class="code" href="namespaceigrf.html#abb628cdea11983720d4d4b8b8b9170f6">kr</a>=1; <a class="code" href="namespaceigrf.html#a251c0354fed8847aba0e599e189b6329">kth</a>=1; }
<a name="l00188"></a>00188     <span class="keywordflow">if</span> (<a class="code" href="namespaceigrf.html#abb628cdea11983720d4d4b8b8b9170f6">kr</a> != 0) { <a class="code" href="namespaceigrf.html#a7a44fcd829906b1b654b13a8b6678038">br</a>=ar; r=ar; }
<a name="l00189"></a>00189     <span class="keywordflow">if</span> (<a class="code" href="namespaceigrf.html#a251c0354fed8847aba0e599e189b6329">kth</a> != 0) { <a class="code" href="namespaceigrf.html#a3167337b67dd9008771f04a48981d248">bthe</a>=athe; <a class="code" href="namespaceigrf.html#a5fa53562f8a37ba64d5f6cb1e82c5e3e">the</a>=athe/<a class="code" href="igrf_8cpp.html#a4cc6bb41fcf089fba3b57ace4750af7d">URAD</a>; <a class="code" href="namespaceigrf.html#ae49465fde6b2fbd446b9992e3d296ff8">cth</a>=cos(<a class="code" href="namespaceigrf.html#a5fa53562f8a37ba64d5f6cb1e82c5e3e">the</a>); <a class="code" href="namespaceigrf.html#a8322c257f5cc921ae48b856b18ef9d68">sth</a>=sin(<a class="code" href="namespaceigrf.html#a5fa53562f8a37ba64d5f6cb1e82c5e3e">the</a>); }
<a name="l00190"></a>00190     <span class="keywordflow">if</span> (<a class="code" href="namespaceigrf.html#a0f1c87af4abbeb720d98948cb163d695">blon</a> != alon) <a class="code" href="namespaceigrf.html#a377d54136a069a1c52999537b8b72036">kph</a>=1;
<a name="l00191"></a>00191     <span class="keywordflow">if</span> (<a class="code" href="namespaceigrf.html#a377d54136a069a1c52999537b8b72036">kph</a> != 0) { <a class="code" href="namespaceigrf.html#a0f1c87af4abbeb720d98948cb163d695">blon</a>=alon; <a class="code" href="namespaceigrf.html#ae1c3cea569b6dc64778870fe439ef072">phi</a>=alon/<a class="code" href="igrf_8cpp.html#a4cc6bb41fcf089fba3b57ace4750af7d">URAD</a>; <a class="code" href="namespaceigrf.html#a26df0bd4407dade228ff3654701c47c0">cph</a>=cos(<a class="code" href="namespaceigrf.html#ae1c3cea569b6dc64778870fe439ef072">phi</a>); <a class="code" href="namespaceigrf.html#af50f2b53f95f4798c1ed26cf8b2465cb">sph</a>=sin(<a class="code" href="namespaceigrf.html#ae1c3cea569b6dc64778870fe439ef072">phi</a>); }
<a name="l00192"></a>00192     fcalc(); *ax=x; *ay=<a class="code" href="namespaceigrf.html#aef378991c40e0acdd01f61c2ef7d3976">y</a>; *az=<a class="code" href="namespaceigrf.html#a331e204532a196349922b6ceb77bfd26">z</a>; *af=<a class="code" href="namespaceigrf.html#a804225ad2942311ba664c4a09e5cd887">f</a>;
<a name="l00193"></a>00193 }
<a name="l00194"></a>00194 
<a name="l00195"></a>00195 <span class="comment">//地心座標から測地座標に変換</span>
<a name="l00196"></a><a class="code" href="namespaceigrf.html#a1fdbe09a6e5b6f5e4a8bb07ce0a161ff">00196</a> <span class="keywordtype">void</span> <a class="code" href="namespaceigrf.html#a1fdbe09a6e5b6f5e4a8bb07ce0a161ff">gcomp</a>(<span class="keywordtype">double</span> *axg, <span class="keywordtype">double</span> *ayg, <span class="keywordtype">double</span> *azg)
<a name="l00197"></a>00197 {   <span class="keywordtype">double</span> <a class="code" href="namespaceigrf.html#abceffa4a56520c69b74fa4400992ec67">bthc</a>, rc, rs, rep2, tlat, tlat2, rlatp, rmc, rmc2, rmc3, ffp, ff;
<a name="l00198"></a>00198     <span class="keywordtype">double</span> cga, sga, xg, zg;
<a name="l00199"></a>00199     <span class="keywordflow">if</span> (<a class="code" href="namespaceigrf.html#a98b997aa944ff7d2e28b495e4dbd3198">kg</a> == 1) { <a class="code" href="namespaceigrf.html#a7800ea2a20171d0727c6a9aed2914464">kgc</a>=0; <a class="code" href="namespaceigrf.html#ac6f5f35bd8a92a659ac6d9e015d963a8">clat</a>=<a class="code" href="namespacestf_1_1util_1_1math.html#aaeb9c85b00f8c1afc33f9009e902e0d4" title="平方根を求める，cmathのラッパ．">sqrt</a>(<a class="code" href="namespaceigrf.html#a5ebdb0cbbff684edd115261744b9b31e">clat2</a>); }
<a name="l00200"></a>00200     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="namespaceigrf.html#a7800ea2a20171d0727c6a9aed2914464">kgc</a>==0) || (bthc!=<a class="code" href="namespaceigrf.html#a3167337b67dd9008771f04a48981d248">bthe</a>)) {
<a name="l00201"></a>00201         <a class="code" href="namespaceigrf.html#a7800ea2a20171d0727c6a9aed2914464">kgc</a>=1; bthc=<a class="code" href="namespaceigrf.html#a3167337b67dd9008771f04a48981d248">bthe</a>; <a class="code" href="namespaceigrf.html#a4f07b29495fc706357f14a3757fe4d9b">slat</a>=<a class="code" href="namespaceigrf.html#ae49465fde6b2fbd446b9992e3d296ff8">cth</a>; <a class="code" href="namespaceigrf.html#ac6f5f35bd8a92a659ac6d9e015d963a8">clat</a>=<a class="code" href="namespaceigrf.html#a8322c257f5cc921ae48b856b18ef9d68">sth</a>;
<a name="l00202"></a>00202         <span class="keywordflow">if</span> (<a class="code" href="namespaceigrf.html#ac6f5f35bd8a92a659ac6d9e015d963a8">clat</a> &gt; 1.5e-9) {
<a name="l00203"></a>00203             rc=r*<a class="code" href="namespaceigrf.html#ae49465fde6b2fbd446b9992e3d296ff8">cth</a>; rs=r*<a class="code" href="namespaceigrf.html#a8322c257f5cc921ae48b856b18ef9d68">sth</a>; rep2=<a class="code" href="namespaceigrf.html#a2990be59fc31675482431fae7fc35519">re2</a>-<a class="code" href="namespaceigrf.html#aa2061b7eae80ebc074b5ed8f60d3919e">rp2</a>; tlat=<a class="code" href="namespaceigrf.html#a4f07b29495fc706357f14a3757fe4d9b">slat</a>/<a class="code" href="namespaceigrf.html#ac6f5f35bd8a92a659ac6d9e015d963a8">clat</a>;
<a name="l00204"></a>00204             tlat2=tlat*tlat; rlat=atan(tlat);
<a name="l00205"></a>00205             <span class="keywordflow">do</span> {rlatp=rlat; rmc2=<a class="code" href="namespaceigrf.html#a2990be59fc31675482431fae7fc35519">re2</a>+rp2*tlat2; rmc=<a class="code" href="namespacestf_1_1util_1_1math.html#aaeb9c85b00f8c1afc33f9009e902e0d4" title="平方根を求める，cmathのラッパ．">sqrt</a>(rmc2);
<a name="l00206"></a>00206                 rmc3=rmc2*rmc; ffp=rp2*rep2*tlat/rmc3+rc/tlat2;
<a name="l00207"></a>00207                 ff=rep2/rmc+rc/tlat-rs; tlat+=ff/ffp;
<a name="l00208"></a>00208                 tlat2=tlat*tlat; rlat=atan(tlat);
<a name="l00209"></a>00209             } <span class="keywordflow">while</span> (fabs(rlat-rlatp) &gt; 1.5e-9);
<a name="l00210"></a>00210             <a class="code" href="namespaceigrf.html#a5ebdb0cbbff684edd115261744b9b31e">clat2</a>=1./(1.+tlat2); <a class="code" href="namespaceigrf.html#ac6f5f35bd8a92a659ac6d9e015d963a8">clat</a>=<a class="code" href="namespacestf_1_1util_1_1math.html#aaeb9c85b00f8c1afc33f9009e902e0d4" title="平方根を求める，cmathのラッパ．">sqrt</a>(<a class="code" href="namespaceigrf.html#a5ebdb0cbbff684edd115261744b9b31e">clat2</a>); <a class="code" href="namespaceigrf.html#a4f07b29495fc706357f14a3757fe4d9b">slat</a>=tlat*<a class="code" href="namespaceigrf.html#ac6f5f35bd8a92a659ac6d9e015d963a8">clat</a>;
<a name="l00211"></a>00211         }
<a name="l00212"></a>00212     }
<a name="l00213"></a>00213     cga=<a class="code" href="namespaceigrf.html#ae49465fde6b2fbd446b9992e3d296ff8">cth</a>*<a class="code" href="namespaceigrf.html#a4f07b29495fc706357f14a3757fe4d9b">slat</a>+<a class="code" href="namespaceigrf.html#a8322c257f5cc921ae48b856b18ef9d68">sth</a>*<a class="code" href="namespaceigrf.html#ac6f5f35bd8a92a659ac6d9e015d963a8">clat</a>; sga=<a class="code" href="namespaceigrf.html#ae49465fde6b2fbd446b9992e3d296ff8">cth</a>*clat-<a class="code" href="namespaceigrf.html#a8322c257f5cc921ae48b856b18ef9d68">sth</a>*<a class="code" href="namespaceigrf.html#a4f07b29495fc706357f14a3757fe4d9b">slat</a>;
<a name="l00214"></a>00214     xg=x*cga-<a class="code" href="namespaceigrf.html#a331e204532a196349922b6ceb77bfd26">z</a>*sga; zg=x*sga+<a class="code" href="namespaceigrf.html#a331e204532a196349922b6ceb77bfd26">z</a>*cga;
<a name="l00215"></a>00215     *axg=xg; *ayg=<a class="code" href="namespaceigrf.html#aef378991c40e0acdd01f61c2ef7d3976">y</a>; *azg=zg;
<a name="l00216"></a>00216 }
<a name="l00217"></a>00217 
<a name="l00218"></a>00218 <span class="comment">/*---------------------------*/</span>
<a name="l00219"></a>00219 <span class="comment">/*   Conventional Routines   */</span>
<a name="l00220"></a>00220 <span class="comment">/*---------------------------*/</span>
<a name="l00221"></a>00221 
<a name="l00222"></a><a class="code" href="igrf_8cpp.html#ad307bf3baef95beb53f5e0ab45ef79f8">00222</a> <span class="preprocessor">#define MxGEN   10</span>
<a name="l00223"></a><a class="code" href="igrf_8cpp.html#ab812f1e2f95156906fcaca00bc6f490e">00223</a> <span class="preprocessor"></span><span class="preprocessor">#define RAD     (180./3.14159265359)</span>
<a name="l00224"></a><a class="code" href="igrf_8cpp.html#a9143135d26d057c2d4d20f11b74f366f">00224</a> <span class="preprocessor"></span><span class="preprocessor">#define MxMOD   19</span>
<a name="l00225"></a><a class="code" href="igrf_8cpp.html#afc81295c5605ff3b2ade67fa3a54fd4b">00225</a> <span class="preprocessor"></span><span class="preprocessor">#define MxELM   ((MxMOD+1)*(MxMOD+1)-1)</span>
<a name="l00226"></a><a class="code" href="igrf_8cpp.html#a19dc5d95e75e199cf5f71ad2e86f5ff6">00226</a> <span class="preprocessor"></span><span class="preprocessor">#define MxCOL   50</span>
<a name="l00227"></a><a class="code" href="igrf_8cpp.html#a3337044b84d2ff50cc1a0934ea1df51e">00227</a> <span class="preprocessor"></span><span class="preprocessor">#define LLINE   (MxCOL*9 + 10)</span>
<a name="l00228"></a>00228 <span class="preprocessor"></span>
<a name="l00229"></a>00229 <span class="comment">//GIGRFの計算（G, D,P-GRFの区別なく計算）</span>
<a name="l00230"></a>00230 <span class="comment">//WGS84モデルで計算</span>
<a name="l00231"></a><a class="code" href="namespaceigrf.html#af2761a05a655cde14b9f8a15b00f582a">00231</a> <span class="keywordtype">void</span> <a class="code" href="namespaceigrf.html#af2761a05a655cde14b9f8a15b00f582a">gigrf</a>(<span class="keywordtype">int</span> gen, <span class="keywordtype">double</span> year)
<a name="l00232"></a>00232 {   <span class="keywordtype">int</span> maxod, i, n, m, l, k, ncol, nlin;
<a name="l00233"></a>00233     <span class="keywordtype">double</span> y1, y2, yr1, yr2;
<a name="l00234"></a>00234     <span class="keywordtype">double</span> <a class="code" href="namespaceigrf.html#a01ec21ff7caa1eb8ab34cef76afdf079">tzero</a>, dmy[3], cb[<a class="code" href="igrf_8cpp.html#afc81295c5605ff3b2ade67fa3a54fd4b">MxELM</a>], cv[<a class="code" href="igrf_8cpp.html#afc81295c5605ff3b2ade67fa3a54fd4b">MxELM</a>];
<a name="l00235"></a>00235     <span class="keywordtype">char</span> path[]=<span class="stringliteral">&quot;igrf10.coef&quot;</span>;
<a name="l00236"></a>00236     <span class="keywordtype">char</span> file[]=<span class="stringliteral">&quot;igrf10.coef&quot;</span>;
<a name="l00237"></a>00237     <span class="keywordtype">char</span> *pstr, *line, buf[<a class="code" href="igrf_8cpp.html#a3337044b84d2ff50cc1a0934ea1df51e">LLINE</a>];
<a name="l00238"></a>00238     FILE *fp;
<a name="l00239"></a>00239     <span class="keywordflow">if</span> ((gen&lt;1) || (<a class="code" href="igrf_8cpp.html#ad307bf3baef95beb53f5e0ab45ef79f8">MxGEN</a>&lt;gen))
<a name="l00240"></a>00240         { fprintf(stderr, <span class="stringliteral">&quot;gigrf: unknown  NGEN = %d\n&quot;</span>, gen); exit(1); }
<a name="l00241"></a>00241     strcpy(file, path);
<a name="l00242"></a>00242     <span class="keywordflow">if</span> ((pstr=strstr(file, <span class="stringliteral">&quot;10&quot;</span>)) == NULL)
<a name="l00243"></a>00243         { fprintf(stderr, <span class="stringliteral">&quot;gigrf: filename invalid\n&quot;</span>); exit(1); }
<a name="l00244"></a>00244     sprintf(buf, <span class="stringliteral">&quot;%02d&quot;</span>, gen); strncpy(pstr, buf, 2);
<a name="l00245"></a>00245     <span class="keywordflow">if</span> ((fp=fopen(file, <span class="stringliteral">&quot;r&quot;</span>)) == NULL)
<a name="l00246"></a>00246         { fprintf(stderr, <span class="stringliteral">&quot;gigrf: file not found\n&quot;</span>); exit(1); }
<a name="l00247"></a>00247     <span class="keywordflow">if</span> (fgets(buf, <a class="code" href="igrf_8cpp.html#a3337044b84d2ff50cc1a0934ea1df51e">LLINE</a>, fp) == NULL)
<a name="l00248"></a>00248         { fprintf(stderr, <span class="stringliteral">&quot;gigrf: file empty\n&quot;</span>); exit(1); }
<a name="l00249"></a>00249     <span class="keywordflow">if</span> (sscanf(buf, <span class="stringliteral">&quot;%d%d%lf%lf&quot;</span>,&amp;maxod,&amp;ncol,&amp;y1,&amp;y2) != 4)
<a name="l00250"></a>00250         { fprintf(stderr, <span class="stringliteral">&quot;gigrf: Line-1 format error\n&quot;</span>); exit(1); }
<a name="l00251"></a>00251     <span class="keywordflow">if</span> ((maxod&lt;8) || (maxod&gt;<a class="code" href="igrf_8cpp.html#a9143135d26d057c2d4d20f11b74f366f">MxMOD</a>) || (ncol&lt;2) || (ncol&gt;<a class="code" href="igrf_8cpp.html#a19dc5d95e75e199cf5f71ad2e86f5ff6">MxCOL</a>))
<a name="l00252"></a>00252         { fprintf(stderr, <span class="stringliteral">&quot;gigrf: Line-1 invalid\n&quot;</span>); exit(1); }
<a name="l00253"></a>00253     nlin = (maxod+1)*(maxod+1) - 1;
<a name="l00254"></a>00254     <span class="keywordflow">if</span> ((year&lt;y1) || (year&gt;y2))
<a name="l00255"></a>00255         fprintf(stderr, <span class="stringliteral">&quot;gigrf: IGRF-%02d not defined for %9.3lf\n&quot;</span>, gen, year);
<a name="l00256"></a>00256     <span class="keywordflow">if</span> (fgets(buf, <a class="code" href="igrf_8cpp.html#a3337044b84d2ff50cc1a0934ea1df51e">LLINE</a>, fp) == NULL)
<a name="l00257"></a>00257         { fprintf(stderr, <span class="stringliteral">&quot;gigrf: EOF before Line-2\n&quot;</span>); exit(1); }
<a name="l00258"></a>00258     line = &amp;buf[1];
<a name="l00259"></a>00259     <span class="keywordflow">if</span> (sscanf(line, <span class="stringliteral">&quot;%*c%*d%*d%lf%n&quot;</span>,&amp;yr2,&amp;n) == EOF)
<a name="l00260"></a>00260         { fprintf(stderr, <span class="stringliteral">&quot;gigrf: Line-2 invalid\n&quot;</span>); exit(1); }
<a name="l00261"></a>00261     <span class="keywordflow">for</span> (l=2; l&lt;ncol; l++) {
<a name="l00262"></a>00262         line += n; yr1 = yr2;
<a name="l00263"></a>00263         <span class="keywordflow">if</span> (sscanf(line, <span class="stringliteral">&quot;%lf%n&quot;</span>,&amp;yr2,&amp;n) == EOF)
<a name="l00264"></a>00264             { fprintf(stderr, <span class="stringliteral">&quot;gigrf: Line-2 short\n&quot;</span>); exit(1); }
<a name="l00265"></a>00265         <span class="keywordflow">if</span> (year &lt; yr2) <span class="keywordflow">break</span>;
<a name="l00266"></a>00266     }
<a name="l00267"></a>00267     <span class="keywordflow">for</span> (i=0; i&lt;nlin; i++) {
<a name="l00268"></a>00268         <span class="keywordflow">if</span> (fgets(buf, <a class="code" href="igrf_8cpp.html#a3337044b84d2ff50cc1a0934ea1df51e">LLINE</a>, fp) == NULL)
<a name="l00269"></a>00269             { fprintf(stderr, <span class="stringliteral">&quot;gigrf: EOF before Line-%d\n&quot;</span>, i+3); exit(1); }
<a name="l00270"></a>00270         line = &amp;buf[0];
<a name="l00271"></a>00271         <span class="keywordflow">if</span> (sscanf(line, <span class="stringliteral">&quot;%*c%*d%*d%n&quot;</span>,&amp;n) == EOF)
<a name="l00272"></a>00272             { fprintf(stderr, <span class="stringliteral">&quot;gigrf: Line-%d invalid\n&quot;</span>, i+3); exit(1); }
<a name="l00273"></a>00273         <span class="keywordflow">for</span> (m=2; m&lt;l; m++) {
<a name="l00274"></a>00274             line += n;
<a name="l00275"></a>00275             <span class="keywordflow">if</span> (sscanf(line, <span class="stringliteral">&quot;%*lf%n&quot;</span>,&amp;n) == EOF)
<a name="l00276"></a>00276                 { fprintf(stderr, <span class="stringliteral">&quot;gigrf: Line-%d short\n&quot;</span>, i+3); exit(1); }
<a name="l00277"></a>00277         }
<a name="l00278"></a>00278         line += n;
<a name="l00279"></a>00279         <span class="keywordflow">if</span> (sscanf(line, <span class="stringliteral">&quot;%lf%lf&quot;</span>,&amp;cb[i],&amp;cv[i]) != 2)
<a name="l00280"></a>00280             { fprintf(stderr, <span class="stringliteral">&quot;gigrf: Line-%d short\n&quot;</span>, i+3); exit(1); }
<a name="l00281"></a>00281     }
<a name="l00282"></a>00282     <span class="keywordflow">if</span> (l == ncol) tzero = yr2;
<a name="l00283"></a>00283     <span class="keywordflow">else</span> {
<a name="l00284"></a>00284         tzero = yr1; yr2 -= yr1;
<a name="l00285"></a>00285         <span class="keywordflow">for</span> (i=0; i&lt;nlin; i++) cv[i] = (cv[i]-cb[i])/yr2;
<a name="l00286"></a>00286     }
<a name="l00287"></a>00287     k = 0;
<a name="l00288"></a>00288     <span class="keywordflow">for</span> (i=0, n=1; n&lt;=maxod; n++) {
<a name="l00289"></a>00289         vgh[0][n]=cb[i]; <a class="code" href="namespaceigrf.html#aa95a5325587e6e46b60fdfbc45bccb36">vght</a>[0][n]=cv[i]; i++;
<a name="l00290"></a>00290         <span class="keywordflow">if</span> ((cb[i]!=0.) || (cv[i]!=0.)) k = n;
<a name="l00291"></a>00291         <span class="keywordflow">for</span> (m=1; m&lt;=n; m++) {
<a name="l00292"></a>00292             vgh[m][n]=cb[i]; <a class="code" href="namespaceigrf.html#aa95a5325587e6e46b60fdfbc45bccb36">vght</a>[m][n]=cv[i]; i++;
<a name="l00293"></a>00293             <span class="keywordflow">if</span> ((cb[i]!=0.) || (cv[i]!=0.)) k = n;
<a name="l00294"></a>00294             vgh[n][m-1]=cb[i]; <a class="code" href="namespaceigrf.html#aa95a5325587e6e46b60fdfbc45bccb36">vght</a>[n][m-1]=cv[i]; i++;
<a name="l00295"></a>00295             <span class="keywordflow">if</span> ((cb[i]!=0.) || (cv[i]!=0.)) k = n;
<a name="l00296"></a>00296         }
<a name="l00297"></a>00297     }
<a name="l00298"></a>00298     maxod = k;
<a name="l00299"></a>00299     <a class="code" href="namespaceigrf.html#af39a8523c9c204bca69a99dda2956b6c">field</a>(6378.137, 298.25722, 6371.2, maxod);
<a name="l00300"></a>00300     <a class="code" href="namespaceigrf.html#a61593015602f60e05150b6d883268b41">tcoef</a>(vgh, <a class="code" href="namespaceigrf.html#aa95a5325587e6e46b60fdfbc45bccb36">vght</a>, tzero, 0, dmy); <a class="code" href="namespaceigrf.html#a5bb32a15af56d15180a5353a06be99d9">tyear</a>(year);
<a name="l00301"></a>00301 }
<a name="l00302"></a>00302 
<a name="l00303"></a><a class="code" href="namespaceigrf.html#aa5947f7656470b8ad4c038aeee4ea925">00303</a> <span class="keywordtype">void</span> <a class="code" href="namespaceigrf.html#aa5947f7656470b8ad4c038aeee4ea925">igrfc</a>(<span class="keywordtype">double</span> fido, <span class="keywordtype">double</span> fkeido, <span class="keywordtype">double</span> hght, <span class="keywordtype">double</span> *tf)
<a name="l00304"></a>00304 {   <span class="keywordtype">double</span> fx, fy, fz;
<a name="l00305"></a>00305     <a class="code" href="namespaceigrf.html#aeece8916124afaf31017aab0755c78f0">mfldg</a>(fido, fkeido, hght/1000., &amp;fx, &amp;fy, &amp;fz, tf);
<a name="l00306"></a>00306 }
<a name="l00307"></a>00307 
<a name="l00308"></a>00308 
<a name="l00309"></a>00309 
<a name="l00310"></a>00310 <span class="comment">//磁気要素に変換</span>
<a name="l00311"></a><a class="code" href="namespaceigrf.html#a7b719570a80e172cb42b87aac9d170f2">00311</a> <span class="keywordtype">void</span> <a class="code" href="namespaceigrf.html#a7b719570a80e172cb42b87aac9d170f2">igrfm</a>(<span class="keywordtype">double</span> fm[6])
<a name="l00312"></a>00312 {   <span class="keywordtype">double</span> gx, gy, gz, h, dip, dec;
<a name="l00313"></a>00313     <a class="code" href="namespaceigrf.html#a1fdbe09a6e5b6f5e4a8bb07ce0a161ff">gcomp</a>(&amp;gx, &amp;gy, &amp;gz);
<a name="l00314"></a>00314     h=<a class="code" href="namespacestf_1_1util_1_1math.html#aaeb9c85b00f8c1afc33f9009e902e0d4" title="平方根を求める，cmathのラッパ．">sqrt</a>(gx*gx+gy*gy); dip=atan2(gz, h); dec=atan2(gy, gx);
<a name="l00315"></a>00315     fm[0]=gx; fm[1]=gy; fm[2]=gz; fm[3]=h; fm[4]=dip*<a class="code" href="igrf_8cpp.html#ab812f1e2f95156906fcaca00bc6f490e">RAD</a>; fm[5]=dec*<a class="code" href="igrf_8cpp.html#ab812f1e2f95156906fcaca00bc6f490e">RAD</a>;
<a name="l00316"></a>00316 }
<a name="l00317"></a>00317 
<a name="l00318"></a>00318 <span class="comment">/*---------------------------------*/</span>
<a name="l00319"></a>00319 <span class="comment">/*   Coefficients setup Routines   */</span>
<a name="l00320"></a>00320 <span class="comment">/*---------------------------------*/</span>
<a name="l00321"></a>00321 
<a name="l00322"></a>00322 <span class="keyword">static</span> <span class="keywordtype">float</span> rf[7][120] = {
<a name="l00323"></a>00323         { -30339., -2123.,  5758.,
<a name="l00324"></a>00324            -1654.,  2994., -2006.,  1567.,   130.,  1297., -2036.,
<a name="l00325"></a>00325           -403., 1289., 242., 843.,-176., 958., 805., 149., 492.,-280.,
<a name="l00326"></a>00326           -392.,   8., 256.,-265.,-223., 357.,  16., 246., 125., -26.,
<a name="l00327"></a>00327           -123.,-161.,-107., -51.,  77.,  47.,  60., -14.,   4., 106.,
<a name="l00328"></a>00328           -229.,  68.,   3., -32.,  -4., -10.,-112., -13.,  71., -54.,
<a name="l00329"></a>00329            -57.,   0., -27.,  12.,  -8., -25.,   9.,  -9.,  23.,  13.,
<a name="l00330"></a>00330            -19.,  -2., -17.,  10.,   9.,   3.,  -3., -13., -12.,   5.,
<a name="l00331"></a>00331             -4., -17.,   7.,   4.,  -5.,  22.,  12.,  -3.,   6., -16.,
<a name="l00332"></a>00332          0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
<a name="l00333"></a>00333          0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
<a name="l00334"></a>00334         { -30186., -2036.,  5735.,
<a name="l00335"></a>00335            -1898.,  2997., -2124.,  1551.,   -37.,  1299., -2144.,
<a name="l00336"></a>00336           -361., 1296., 249., 805.,-253., 951., 807., 148., 462.,-264.,
<a name="l00337"></a>00337           -393.,  37., 235.,-307.,-204., 368.,  39., 275., 142., -20.,
<a name="l00338"></a>00338           -147.,-161., -99., -38.,  74.,  46.,  57., -23.,  15., 102.,
<a name="l00339"></a>00339           -210.,  88.,  -1., -43.,  -8.,  -9.,-114.,  -4.,  66., -57.,
<a name="l00340"></a>00340            -68.,  -7., -24.,   7.,  -4., -22.,  11.,  -9.,  27.,  11.,
<a name="l00341"></a>00341            -17.,  -8., -14.,  11.,  13.,   4.,   3., -15., -12.,   2.,
<a name="l00342"></a>00342             -4., -19.,   6.,   1.,  -2.,  18.,   9.,  -6.,   1., -19.,
<a name="l00343"></a>00343          0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
<a name="l00344"></a>00344          0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.},
<a name="l00345"></a>00345         { -29988., -1957.,  5606.,
<a name="l00346"></a>00346            -1997.,  3028., -2129.,  1662.,  -199.,  1279., -2181.,
<a name="l00347"></a>00347           -335., 1251., 271., 833.,-252., 938., 783., 212., 398.,-257.,
<a name="l00348"></a>00348           -419.,  53., 199.,-298.,-219., 357.,  46., 261., 149., -74.,
<a name="l00349"></a>00349           -150.,-162., -78., -48.,  92.,  49.,  65., -15.,  42.,  93.,
<a name="l00350"></a>00350           -192.,  71.,   4., -43.,  14.,  -2.,-108.,  17.,  70., -59.,
<a name="l00351"></a>00351            -83.,   2., -28.,  20.,  -5., -13.,  16.,   1.,  18.,  11.,
<a name="l00352"></a>00352            -23.,  -2., -10.,  20.,   7.,   7.,   1., -18., -11.,   4.,
<a name="l00353"></a>00353             -7., -22.,   4.,   9.,   3.,  16.,   7., -13.,  -1., -15.,
<a name="l00354"></a>00354              6.,  11., -21.,   2.,  16., -12.,   9.,   9.,  -5.,  -3.,
<a name="l00355"></a>00355             -7.,  -1.,   9.,   7.,  10.,   1.,  -6.,  -5.,   2.,  -3.,
<a name="l00356"></a>00356             -4.,   1.,   2.,   1.,  -5.,   2.,  -2.,   5.,   5.,  -4.,
<a name="l00357"></a>00357              3.,  -1.,   1.,  -2.,   2.,   4.,   3.,  -1.,   0.,  -6.},
<a name="l00358"></a>00358         { -29877., -1903.,  5497.,
<a name="l00359"></a>00359            -2073.,  3045., -2191.,  1691.,  -309.,  1300., -2208.,
<a name="l00360"></a>00360           -312., 1244., 284., 835.,-296., 937., 780., 233., 363.,-250.,
<a name="l00361"></a>00361           -426.,  68., 169.,-298.,-215., 356.,  47., 253., 148., -94.,
<a name="l00362"></a>00362           -155.,-161., -75., -48.,  95.,  52.,  65., -16.,  50.,  90.,
<a name="l00363"></a>00363           -186.,  69.,   4., -50.,  17.,  -4.,-102.,  20.,  75., -61.,
<a name="l00364"></a>00364            -82.,   2., -26.,  24.,  -1.,  -6.,  23.,   4.,  17.,   9.,
<a name="l00365"></a>00365            -21.,   0.,  -6.,  21.,   6.,   7.,   0., -21., -11.,   5.,
<a name="l00366"></a>00366             -9., -25.,   2.,  11.,   4.,  12.,   4., -16.,  -6., -10.,
<a name="l00367"></a>00367              5.,  10., -21.,   1.,  16., -12.,   9.,   9.,  -5.,  -3.,
<a name="l00368"></a>00368             -6.,  -1.,   9.,   7.,  10.,   2.,  -6.,  -5.,   2.,  -4.,
<a name="l00369"></a>00369             -4.,   1.,   2.,   0.,  -5.,   3.,  -2.,   6.,   5.,  -4.,
<a name="l00370"></a>00370              3.,   0.,   1.,  -1.,   2.,   4.,   3.,   0.,   0.,  -6.},
<a name="l00371"></a>00371         { -29775., -1851.,  5411.,
<a name="l00372"></a>00372            -2136.,  3058., -2278.,  1693.,  -380.,  1315., -2240.,
<a name="l00373"></a>00373           -287., 1246., 293., 807.,-348., 939., 782., 248., 324.,-240.,
<a name="l00374"></a>00374           -423.,  87., 142.,-299.,-211., 353.,  47., 244., 153.,-111.,
<a name="l00375"></a>00375           -154.,-166., -69., -37.,  98.,  61.,  64., -16.,  60.,  83.,
<a name="l00376"></a>00376           -178.,  68.,   2., -52.,  17.,   2., -96.,  27.,  77., -64.,
<a name="l00377"></a>00377            -81.,   4., -27.,  28.,   1.,   1.,  20.,   6.,  16.,  10.,
<a name="l00378"></a>00378            -23.,   0.,  -5.,  22.,   5.,  10.,  -1., -20., -11.,   7.,
<a name="l00379"></a>00379            -12., -22.,   4.,  12.,   4.,  11.,   3., -16.,  -6., -11.,
<a name="l00380"></a>00380              4.,  10., -21.,   1.,  15., -12.,  10.,   9.,  -6.,  -4.,
<a name="l00381"></a>00381             -6.,  -1.,   9.,   7.,   9.,   2.,  -7.,  -6.,   2.,  -4.,
<a name="l00382"></a>00382             -4.,   1.,   2.,   0.,  -5.,   3.,  -2.,   6.,   4.,  -4.,
<a name="l00383"></a>00383              3.,   0.,   1.,  -1.,   2.,   4.,   3.,   0.,   0.,  -6.},
<a name="l00384"></a>00384         { -29682., -1789.,  5318.,
<a name="l00385"></a>00385            -2197.,  3074., -2356.,  1685.,  -425.,  1329., -2268.,
<a name="l00386"></a>00386           -263., 1249., 302., 769.,-406., 941., 782., 262., 291.,-232.,
<a name="l00387"></a>00387           -421.,  98., 116.,-301.,-210., 352.,  44., 237., 157.,-122.,
<a name="l00388"></a>00388           -152.,-167., -64., -26.,  99.,  66.,  64., -16.,  65.,  77.,
<a name="l00389"></a>00389           -172.,  67.,   2., -57.,  17.,   4., -94.,  28.,  78., -67.,
<a name="l00390"></a>00390            -77.,   1., -25.,  29.,   3.,   4.,  22.,   8.,  16.,  10.,
<a name="l00391"></a>00391            -23.,  -2.,  -3.,  24.,   4.,  12.,  -1., -20.,  -9.,   7.,
<a name="l00392"></a>00392            -14., -21.,   4.,  12.,   5.,  10.,   0., -17.,  -7., -10.,
<a name="l00393"></a>00393              4.,   9., -19.,   1.,  15., -12.,  11.,   9.,  -7.,  -4.,
<a name="l00394"></a>00394             -7.,  -2.,   9.,   7.,   7.,   0.,  -8.,  -6.,   1.,  -3.,
<a name="l00395"></a>00395             -4.,   2.,   2.,   1.,  -5.,   3.,  -2.,   6.,   4.,  -4.,
<a name="l00396"></a>00396              3.,   0.,   1.,  -2.,   3.,   3.,   3.,  -1.,   0.,  -6.},
<a name="l00397"></a>00397         { -29615., -1728.,  5186.,
<a name="l00398"></a>00398            -2267.,  3072., -2478.,  1672.,  -458.,  1341., -2290.,
<a name="l00399"></a>00399           -227., 1253., 296., 715.,-492., 935., 787., 272., 251.,-232.,
<a name="l00400"></a>00400           -405., 119., 110.,-304.,-217., 351.,  44., 222., 172.,-131.,
<a name="l00401"></a>00401           -134.,-169., -40., -12., 107.,  72.,  68., -17.,  74.,  64.,
<a name="l00402"></a>00402           -161.,  65.,  -5., -61.,  17.,   1., -91.,  44.,  79., -74.,
<a name="l00403"></a>00403            -65.,   0., -24.,  33.,   6.,   9.,  24.,   7.,  15.,   8.,
<a name="l00404"></a>00404            -25.,  -2.,  -6.,  25.,   6.,  12.,  -9., -22.,  -8.,   8.,
<a name="l00405"></a>00405            -17., -21.,   9.,  15.,   7.,   9.,  -8., -16.,  -7.,  -3.,
<a name="l00406"></a>00406              5.,   9., -20.,   3.,  13.,  -8.,  12.,   6.,  -6.,  -9.,
<a name="l00407"></a>00407             -8.,  -2.,   9.,   9.,   4.,  -4.,  -8.,  -8.,   5.,  -2.,
<a name="l00408"></a>00408             -6.,   1.,   2.,   0.,  -3.,   4.,   0.,   5.,   4.,  -6.,
<a name="l00409"></a>00409              1.,  -1.,   2.,  -3.,   4.,   0.,   0.,  -2.,  -1.,  -8.} };
<a name="l00410"></a>00410 <span class="keyword">static</span> <span class="keywordtype">float</span> sv[7][80] = {
<a name="l00411"></a>00411         {  15.3,  8.7, -2.3,-24.4,  0.3,-11.8, -1.6,-16.7,  0.2,-10.8,
<a name="l00412"></a>00412             4.2,  0.7,  0.7, -3.8, -7.7, -0.7,  0.2, -0.1, -3.0,  1.6,
<a name="l00413"></a>00413            -0.1,  2.9, -2.1, -4.2,  1.9,  1.1,  2.3,  2.9,  1.7,  0.6,
<a name="l00414"></a>00414            -2.4,  0.0,  0.8,  1.3, -0.3, -0.1, -0.3, -0.9,  1.1, -0.4,
<a name="l00415"></a>00415             1.9,  2.0, -0.4, -1.1, -0.4,  0.1, -0.2,  0.9, -0.5, -0.3,
<a name="l00416"></a>00416            -1.1, -0.7,  0.3, -0.5,  0.4,  0.3,  0.2,  0.0,  0.4, -0.2,
<a name="l00417"></a>00417             0.2, -0.6,  0.3,  0.1,  0.4,  0.1,  0.6, -0.2,  0.0, -0.3,
<a name="l00418"></a>00418             0.0, -0.2, -0.1, -0.3,  0.3, -0.4, -0.3, -0.3, -0.5, -0.3},
<a name="l00419"></a>00419         {  25.6, 10.0,-10.2,-24.9,  0.7, -3.0,  4.3,-18.9, -3.8,-10.4,
<a name="l00420"></a>00420             6.9, -4.1,  2.5, -4.2, -5.0, -0.2, -2.0,  5.0, -3.9,  0.8,
<a name="l00421"></a>00421            -2.1,  1.7, -3.1, -1.0,  0.3, -0.7,  1.2,  1.1,  2.3, -1.6,
<a name="l00422"></a>00422            -2.0, -0.5,  1.3,  1.0,  1.1,  0.2,  0.5, -0.5,  2.0, -0.1,
<a name="l00423"></a>00423             2.8, -0.2,  0.0, -1.3,  0.9,  0.7, -0.1,  1.7,  0.0,  0.0,
<a name="l00424"></a>00424            -1.4,  0.0, -0.1,  0.6,  0.3,  0.9,  0.3,  0.3, -0.7,  0.3,
<a name="l00425"></a>00425             0.1, -0.5,  0.8,  0.2,  0.3, -0.2,  0.0, -0.4,  0.2, -0.2,
<a name="l00426"></a>00426            -0.4, -0.3, -0.3,  0.4,  0.6, -0.3, -0.3, -0.6, -0.1,  0.3},
<a name="l00427"></a>00427         {  22.4, 11.3,-15.9,-18.3,  3.2,-12.7,  7.0,-25.2,  0.0, -6.5,
<a name="l00428"></a>00428             0.2, -0.7,  2.7,  1.0, -7.9, -1.4, -1.4,  4.6, -8.2,  1.6,
<a name="l00429"></a>00429            -1.8,  2.9, -5.0,  0.4,  1.5,  0.4,  1.8, -0.8, -0.4, -3.3,
<a name="l00430"></a>00430             0.0,  0.2,  1.3,  1.4,  2.1,  0.4,  0.0, -0.5,  3.4, -1.4,
<a name="l00431"></a>00431             0.8,  0.0,  0.8, -1.6,  0.3,  0.5, -0.1,  0.0, -1.0, -0.8,
<a name="l00432"></a>00432            -0.4,  0.4,  0.4,  0.5,  0.2,  1.6,  1.4,  0.1, -0.5,  0.1,
<a name="l00433"></a>00433            -0.1,  0.0,  1.1,  0.8, -0.2, -0.1, -0.3, -0.7,  0.3,  0.0,
<a name="l00434"></a>00434            -0.8, -0.8, -0.2,  0.2,  0.7,  0.2, -0.3, -1.1,  1.2,  0.8},
<a name="l00435"></a>00435         {  23.2, 10.0,-24.5,-13.7,  3.4,-11.5,  7.0,-20.2,  5.1, -4.6,
<a name="l00436"></a>00436             5.3, -0.6,  2.3,  0.1,-10.8,  0.1, -0.6,  3.8, -7.8,  2.2,
<a name="l00437"></a>00437            -1.4,  2.5, -6.8,  0.9,  1.3,  0.1,  0.1, -1.5, -0.2, -3.2,
<a name="l00438"></a>00438            -0.1,  0.1,  0.6, -0.1,  0.0,  1.4, -0.3, -0.4,  1.7, -1.1,
<a name="l00439"></a>00439             0.6, -0.8,  0.0, -2.3,  0.9, -0.5,  1.2, -0.1,  0.2, -0.6,
<a name="l00440"></a>00440             0.2, -0.5,  1.0,  0.8,  1.1,  1.0,  1.9,  0.4,  0.3, -0.5,
<a name="l00441"></a>00441             0.2, -0.1,  0.9,  0.7,  0.0,  0.1,  0.3, -1.0,  0.4,  0.1,
<a name="l00442"></a>00442            -0.3, -0.8, -0.3,  0.2,  0.1, -0.8, -0.5, -0.1, -0.8,  1.3},
<a name="l00443"></a>00443         {  18.0, 10.6,-16.1,-12.9,  2.4,-15.8,  0.0,-13.8,  3.3, -6.7,
<a name="l00444"></a>00444             4.4,  0.1,  1.6, -5.9,-10.6,  0.5,  0.6,  2.6, -7.0,  1.8,
<a name="l00445"></a>00445             0.5,  3.1, -5.5, -1.4,  0.6, -0.1, -0.1, -1.6,  0.5, -3.1,
<a name="l00446"></a>00446             0.4, -0.1,  1.7,  2.3,  0.4,  1.3, -0.2,  0.2,  1.8, -1.3,
<a name="l00447"></a>00447             1.3,  0.0, -0.2, -0.9,  0.1,  0.5,  1.2,  1.2,  0.6, -0.5,
<a name="l00448"></a>00448             0.6, -0.3,  0.2,  0.6,  0.8,  1.6, -0.5,  0.2, -0.2,  0.2,
<a name="l00449"></a>00449             0.0,  0.3,  0.0,  0.2, -0.7,  0.5, -0.2, -0.2,  0.1,  0.3,
<a name="l00450"></a>00450            -1.1,  0.3,  0.0,  0.4, -0.1, -0.5, -0.5, -0.3, -0.6,  0.6},
<a name="l00451"></a>00451         {  17.6, 13.0,-18.3,-13.2,  3.7,-15.0, -0.8, -8.8,  1.5, -6.4,
<a name="l00452"></a>00452             4.1, -0.2,  2.2, -8.1,-12.1,  0.8,  0.9,  1.8, -6.9,  1.2,
<a name="l00453"></a>00453             0.5,  2.7, -4.6, -1.0,  0.8,  0.1,  0.2, -1.5,  1.2, -2.0,
<a name="l00454"></a>00454             0.3, -0.1,  1.8,  2.3,  0.9,  0.5, -0.4,  0.3,  0.6, -1.6,
<a name="l00455"></a>00455             1.9, -0.2, -0.2, -0.9, -0.2,  1.0,  0.0,  2.2, -0.2, -0.8,
<a name="l00456"></a>00456             0.8, -0.6,  0.2,  0.6,  0.6,  1.2, -0.4,  0.1,  0.0,  0.2,
<a name="l00457"></a>00457            -0.3, -0.6,  0.0,  0.3, -0.2,  0.4,  0.1, -0.2,  0.4,  0.2,
<a name="l00458"></a>00458            -1.1,  0.7,  0.3,  0.0,  0.2, -1.2, -0.9, -0.7, -0.3, -0.6},
<a name="l00459"></a>00459         {  14.6, 10.7,-22.5,-12.4,  1.1,-20.6, -1.1, -9.6,  0.7, -5.4,
<a name="l00460"></a>00460             6.0,  0.9, -0.1, -7.7,-14.2, -1.3,  1.6,  2.1, -7.3,  1.3,
<a name="l00461"></a>00461             2.9,  5.0, -3.2,  0.3,  0.0, -0.7, -0.1, -2.1,  0.6, -2.8,
<a name="l00462"></a>00462             1.7, -0.8,  1.9,  2.5,  0.1,  1.0, -0.4, -0.2,  0.9, -1.4,
<a name="l00463"></a>00463             2.0,  0.0, -0.6, -0.8, -0.3,  0.0,  1.2,  0.9, -0.4, -0.4,
<a name="l00464"></a>00464             1.1, -0.3,  0.0,  1.1,  0.3,  1.1, -0.1, -0.2, -0.6,  0.6,
<a name="l00465"></a>00465            -0.7, -0.9,  0.2, -0.3,  0.2,  0.1, -0.3,  0.0,  0.4,  0.0,
<a name="l00466"></a>00466            -1.0,  0.3,  0.3,  0.6, -0.5, -0.4, -0.7,  0.3, -0.4,  0.7} };
<a name="l00467"></a>00467 <span class="keyword">static</span> <span class="keywordtype">float</span> df[10][120] = {
<a name="l00468"></a>00468         { -30594., -2285.,  5810.,
<a name="l00469"></a>00469            -1244.,  2990., -1702.,  1578.,   477.,  1282., -1834.,
<a name="l00470"></a>00470           -499., 1255., 186., 913., -11., 944., 776., 144., 544.,-276.,
<a name="l00471"></a>00471           -421., -55., 304.,-178.,-253., 346., -12., 194.,  95., -20.,
<a name="l00472"></a>00472            -67.,-142.,-119., -82.,  82.,  59.,  57.,   6.,   6., 100.,
<a name="l00473"></a>00473           -246.,  16., -25.,  -9.,  21., -16.,-104., -39.,  70., -40.,
<a name="l00474"></a>00474            -45.,   0., -18.,   0.,   2., -29.,   6., -10.,  28.,  15.,
<a name="l00475"></a>00475            -17.,  29., -22.,  13.,   7.,  12.,  -8., -21.,  -5., -12.,
<a name="l00476"></a>00476              9.,  -7.,   7.,   2., -10.,  18.,   7.,   3.,   2., -11.,
<a name="l00477"></a>00477              5., -21., -27.,   1.,  17., -11.,  29.,   3.,  -9.,  16.,
<a name="l00478"></a>00478              4.,  -3.,   9.,  -4.,   6.,  -3.,   1.,  -4.,   8.,  -3.,
<a name="l00479"></a>00479             11.,   5.,   1.,   1.,   2., -20.,  -5.,  -1.,  -1.,  -6.,
<a name="l00480"></a>00480              8.,   6.,  -1.,  -4.,  -3.,  -2.,   5.,   0.,  -2.,  -2.},
<a name="l00481"></a>00481         { -30554., -2250.,  5815.,
<a name="l00482"></a>00482            -1341.,  2998., -1810.,  1576.,   381.,  1297., -1889.,
<a name="l00483"></a>00483           -476., 1274., 206., 896., -46., 954., 792., 136., 528.,-278.,
<a name="l00484"></a>00484           -408., -37., 303.,-210.,-240., 349.,   3., 211., 103., -20.,
<a name="l00485"></a>00485            -87.,-147.,-122., -76.,  80.,  54.,  57.,  -1.,   4.,  99.,
<a name="l00486"></a>00486           -247.,  33., -16., -12.,  12., -12.,-105., -30.,  65., -55.,
<a name="l00487"></a>00487            -35.,   2., -17.,   1.,   0., -40.,  10.,  -7.,  36.,   5.,
<a name="l00488"></a>00488            -18.,  19., -16.,  22.,  15.,   5.,  -4., -22.,  -1.,   0.,
<a name="l00489"></a>00489             11., -21.,  15.,  -8., -13.,  17.,   5.,  -4.,  -1., -17.,
<a name="l00490"></a>00490              3.,  -7., -24.,  -1.,  19., -25.,  12.,  10.,   2.,   5.,
<a name="l00491"></a>00491              2.,  -5.,   8.,  -2.,   8.,   3., -11.,   8.,  -7.,  -8.,
<a name="l00492"></a>00492              4.,  13.,  -1.,  -2.,  13., -10.,  -4.,   2.,   4.,  -3.,
<a name="l00493"></a>00493             12.,   6.,   3.,  -3.,   2.,   6.,  10.,  11.,   3.,   8.},
<a name="l00494"></a>00494         { -30500., -2215.,  5820.,
<a name="l00495"></a>00495            -1440.,  3003., -1898.,  1581.,   291.,  1302., -1944.,
<a name="l00496"></a>00496           -462., 1288., 216., 882., -83., 958., 796., 133., 510.,-274.,
<a name="l00497"></a>00497           -397., -23., 290.,-230.,-229., 360.,  15., 230., 110., -23.,
<a name="l00498"></a>00498            -98.,-152.,-121., -69.,  78.,  47.,  57.,  -9.,   3.,  96.,
<a name="l00499"></a>00499           -247.,  48.,  -8., -16.,   7., -12.,-107., -24.,  65., -56.,
<a name="l00500"></a>00500            -50.,   2., -24.,  10.,  -4., -32.,   8., -11.,  28.,   9.,
<a name="l00501"></a>00501            -20.,  18., -18.,  11.,   9.,  10.,  -6., -15., -14.,   5.,
<a name="l00502"></a>00502              6., -23.,  10.,   3.,  -7.,  23.,   6.,  -4.,   9., -13.,
<a name="l00503"></a>00503              4.,   9., -11.,  -4.,  12.,  -5.,   7.,   2.,   6.,   4.,
<a name="l00504"></a>00504             -2.,   1.,  10.,   2.,   7.,   2.,  -6.,   5.,   5.,  -3.,
<a name="l00505"></a>00505             -5.,  -4.,  -1.,   0.,   2.,  -8.,  -3.,  -2.,   7.,  -4.,
<a name="l00506"></a>00506              4.,   1.,  -2.,  -3.,   6.,   7.,  -2.,  -1.,   0.,  -3.},
<a name="l00507"></a>00507         { -30421., -2169.,  5791.,
<a name="l00508"></a>00508            -1555.,  3002., -1967.,  1590.,   206.,  1302., -1992.,
<a name="l00509"></a>00509           -414., 1289., 224., 878.,-130., 957., 800., 135., 504.,-278.,
<a name="l00510"></a>00510           -394.,   3., 269.,-255.,-222., 362.,  16., 242., 125., -26.,
<a name="l00511"></a>00511           -117.,-156.,-114., -63.,  81.,  46.,  58., -10.,   1.,  99.,
<a name="l00512"></a>00512           -237.,  60.,  -1., -20.,  -2., -11.,-113., -17.,  67., -56.,
<a name="l00513"></a>00513            -55.,   5., -28.,  15.,  -6., -32.,   7.,  -7.,  23.,  17.,
<a name="l00514"></a>00514            -18.,   8., -17.,  15.,   6.,  11.,  -4., -14., -11.,   7.,
<a name="l00515"></a>00515              2., -18.,  10.,   4.,  -5.,  23.,  10.,   1.,   8., -20.,
<a name="l00516"></a>00516              4.,   6., -18.,   0.,  12.,  -9.,   2.,   1.,   0.,   4.,
<a name="l00517"></a>00517             -3.,  -1.,   9.,  -2.,   8.,   3.,   0.,  -1.,   5.,   1.,
<a name="l00518"></a>00518             -3.,   4.,   4.,   1.,   0.,   0.,  -1.,   2.,   4.,  -5.,
<a name="l00519"></a>00519              6.,   1.,   1.,  -1.,  -1.,   6.,   2.,   0.,   0.,  -7.},
<a name="l00520"></a>00520         { -30334., -2119.,  5776.,
<a name="l00521"></a>00521            -1662.,  2997., -2016.,  1594.,   114.,  1297., -2038.,
<a name="l00522"></a>00522           -404., 1292., 240., 856.,-165., 957., 804., 148., 479.,-269.,
<a name="l00523"></a>00523           -390.,  13., 252.,-269.,-219., 358.,  19., 254., 128., -31.,
<a name="l00524"></a>00524           -126.,-157., -97., -62.,  81.,  45.,  61., -11.,   8., 100.,
<a name="l00525"></a>00525           -228.,  68.,   4., -32.,   1.,  -8.,-111.,  -7.,  75., -57.,
<a name="l00526"></a>00526            -61.,   4., -27.,  13.,  -2., -26.,   6.,  -6.,  26.,  13.,
<a name="l00527"></a>00527            -23.,   1., -12.,  13.,   5.,   7.,  -4., -12., -14.,   9.,
<a name="l00528"></a>00528              0., -16.,   8.,   4.,  -1.,  24.,  11.,  -3.,   4., -17.,
<a name="l00529"></a>00529              8.,  10., -22.,   2.,  15., -13.,   7.,  10.,  -4.,  -1.,
<a name="l00530"></a>00530             -5.,  -1.,  10.,   5.,  10.,   1.,  -4.,  -2.,   1.,  -2.,
<a name="l00531"></a>00531             -3.,   2.,   2.,   1.,  -5.,   2.,  -2.,   6.,   4.,  -4.,
<a name="l00532"></a>00532              4.,   0.,   0.,  -2.,   2.,   3.,   2.,   0.,   0.,  -6.},
<a name="l00533"></a>00533         { -30220., -2068.,  5737.,
<a name="l00534"></a>00534            -1781.,  3000., -2047.,  1611.,    25.,  1287., -2091.,
<a name="l00535"></a>00535           -366., 1278., 251., 838.,-196., 952., 800., 167., 461.,-266.,
<a name="l00536"></a>00536           -395.,  26., 234.,-279.,-216., 359.,  26., 262., 139., -42.,
<a name="l00537"></a>00537           -139.,-160., -91., -56.,  83.,  43.,  64., -12.,  15., 100.,
<a name="l00538"></a>00538           -212.,  72.,   2., -37.,   3.,  -6.,-112.,   1.,  72., -57.,
<a name="l00539"></a>00539            -70.,   1., -27.,  14.,  -4., -22.,   8.,  -2.,  23.,  13.,
<a name="l00540"></a>00540            -23.,  -2., -11.,  14.,   6.,   7.,  -2., -15., -13.,   6.,
<a name="l00541"></a>00541             -3., -17.,   5.,   6.,   0.,  21.,  11.,  -6.,   3., -16.,
<a name="l00542"></a>00542              8.,  10., -21.,   2.,  16., -12.,   6.,  10.,  -4.,  -1.,
<a name="l00543"></a>00543             -5.,   0.,  10.,   3.,  11.,   1.,  -2.,  -1.,   1.,  -3.,
<a name="l00544"></a>00544             -3.,   1.,   2.,   1.,  -5.,   3.,  -1.,   4.,   6.,  -4.,
<a name="l00545"></a>00545              4.,   0.,   1.,  -1.,   0.,   3.,   3.,   1.,  -1.,  -4.},
<a name="l00546"></a>00546         { -30100., -2013.,  5675.,
<a name="l00547"></a>00547            -1902.,  3010., -2067.,  1632.,   -68.,  1276., -2144.,
<a name="l00548"></a>00548           -333., 1260., 262., 830.,-223., 946., 791., 191., 438.,-265.,
<a name="l00549"></a>00549           -405.,  39., 216.,-288.,-218., 356.,  31., 264., 148., -59.,
<a name="l00550"></a>00550           -152.,-159., -83., -49.,  88.,  45.,  66., -13.,  28.,  99.,
<a name="l00551"></a>00551           -198.,  75.,   1., -41.,   6.,  -4.,-111.,  11.,  71., -56.,
<a name="l00552"></a>00552            -77.,   1., -26.,  16.,  -5., -14.,  10.,   0.,  22.,  12.,
<a name="l00553"></a>00553            -23.,  -5., -12.,  14.,   6.,   6.,  -1., -16., -12.,   4.,
<a name="l00554"></a>00554             -8., -19.,   4.,   6.,   0.,  18.,  10., -10.,   1., -17.,
<a name="l00555"></a>00555              7.,  10., -21.,   2.,  16., -12.,   7.,  10.,  -4.,  -1.,
<a name="l00556"></a>00556             -5.,  -1.,  10.,   4.,  11.,   1.,  -3.,  -2.,   1.,  -3.,
<a name="l00557"></a>00557             -3.,   1.,   2.,   1.,  -5.,   3.,  -2.,   4.,   5.,  -4.,
<a name="l00558"></a>00558              4.,  -1.,   1.,  -1.,   0.,   3.,   3.,   1.,  -1.,  -5.},
<a name="l00559"></a>00559         { -29992., -1956.,  5604.,
<a name="l00560"></a>00560            -1997.,  3027., -2129.,  1663.,  -200.,  1281., -2180.,
<a name="l00561"></a>00561           -336., 1251., 271., 833.,-252., 938., 782., 212., 398.,-257.,
<a name="l00562"></a>00562           -419.,  53., 199.,-297.,-218., 357.,  46., 261., 150., -74.,
<a name="l00563"></a>00563           -151.,-162., -78., -48.,  92.,  48.,  66., -15.,  42.,  93.,
<a name="l00564"></a>00564           -192.,  71.,   4., -43.,  14.,  -2.,-108.,  17.,  72., -59.,
<a name="l00565"></a>00565            -82.,   2., -27.,  21.,  -5., -12.,  16.,   1.,  18.,  11.,
<a name="l00566"></a>00566            -23.,  -2., -10.,  18.,   6.,   7.,   0., -18., -11.,   4.,
<a name="l00567"></a>00567             -7., -22.,   4.,   9.,   3.,  16.,   6., -13.,  -1., -15.,
<a name="l00568"></a>00568              5.,  10., -21.,   1.,  16., -12.,   9.,   9.,  -5.,  -3.,
<a name="l00569"></a>00569             -6.,  -1.,   9.,   7.,  10.,   2.,  -6.,  -5.,   2.,  -4.,
<a name="l00570"></a>00570             -4.,   1.,   2.,   0.,  -5.,   3.,  -2.,   6.,   5.,  -4.,
<a name="l00571"></a>00571              3.,   0.,   1.,  -1.,   2.,   4.,   3.,   0.,   0.,  -6.},
<a name="l00572"></a>00572         { -29873., -1905.,  5500.,
<a name="l00573"></a>00573            -2072.,  3044., -2197.,  1687.,  -306.,  1296., -2208.,
<a name="l00574"></a>00574           -310., 1247., 284., 829.,-297., 936., 780., 232., 361.,-249.,
<a name="l00575"></a>00575           -424.,  69., 170.,-297.,-214., 355.,  47., 253., 150., -93.,
<a name="l00576"></a>00576           -154.,-164., -75., -46.,  95.,  53.,  65., -16.,  51.,  88.,
<a name="l00577"></a>00577           -185.,  69.,   4., -48.,  16.,  -1.,-102.,  21.,  74., -62.,
<a name="l00578"></a>00578            -83.,   3., -27.,  24.,  -2.,  -6.,  20.,   4.,  17.,  10.,
<a name="l00579"></a>00579            -23.,   0.,  -7.,  21.,   6.,   8.,   0., -19., -11.,   5.,
<a name="l00580"></a>00580             -9., -23.,   4.,  11.,   4.,  14.,   4., -15.,  -4., -11.,
<a name="l00581"></a>00581              5.,  10., -21.,   1.,  15., -12.,   9.,   9.,  -6.,  -3.,
<a name="l00582"></a>00582             -6.,  -1.,   9.,   7.,   9.,   1.,  -7.,  -5.,   2.,  -4.,
<a name="l00583"></a>00583             -4.,   1.,   3.,   0.,  -5.,   3.,  -2.,   6.,   5.,  -4.,
<a name="l00584"></a>00584              3.,   0.,   1.,  -1.,   2.,   4.,   3.,   0.,   0.,  -6.},
<a name="l00585"></a>00585         { -29775., -1848.,  5406.,
<a name="l00586"></a>00586            -2131.,  3059., -2279.,  1686.,  -373.,  1314., -2239.,
<a name="l00587"></a>00587           -284., 1248., 293., 802.,-352., 939., 780., 247., 325.,-240.,
<a name="l00588"></a>00588           -423.,  84., 141.,-299.,-214., 353.,  46., 245., 154.,-109.,
<a name="l00589"></a>00589           -153.,-165., -69., -36.,  97.,  61.,  65., -16.,  59.,  82.,
<a name="l00590"></a>00590           -178.,  69.,   3., -52.,  18.,   1., -96.,  24.,  77., -64.,
<a name="l00591"></a>00591            -80.,   2., -26.,  26.,   0.,  -1.,  21.,   5.,  17.,   9.,
<a name="l00592"></a>00592            -23.,   0.,  -4.,  23.,   5.,  10.,  -1., -19., -10.,   6.,
<a name="l00593"></a>00593            -12., -22.,   3.,  12.,   4.,  12.,   2., -16.,  -6., -10.,
<a name="l00594"></a>00594              4.,   9., -20.,   1.,  15., -12.,  11.,   9.,  -7.,  -4.,
<a name="l00595"></a>00595             -7.,  -2.,   9.,   7.,   8.,   1.,  -7.,  -6.,   2.,  -3.,
<a name="l00596"></a>00596             -4.,   2.,   2.,   1.,  -5.,   3.,  -2.,   6.,   4.,  -4.,
<a name="l00597"></a>00597              3.,   0.,   1.,  -2.,   3.,   3.,   3.,  -1.,   0.,  -6.} };
<a name="l00598"></a>00598 
<a name="l00599"></a><a class="code" href="namespaceigrf.html#a8aba3afa49e48d61b9ed2ca3424dc898">00599</a> <span class="keywordtype">void</span> <a class="code" href="namespaceigrf.html#a8aba3afa49e48d61b9ed2ca3424dc898">sigrf</a>(<span class="keywordtype">double</span> year)
<a name="l00600"></a>00600 {   <span class="keywordtype">int</span> maxod, i, n, m, l;
<a name="l00601"></a>00601     <span class="keywordtype">double</span> <a class="code" href="namespaceigrf.html#a01ec21ff7caa1eb8ab34cef76afdf079">tzero</a>, dmy[3];
<a name="l00602"></a>00602     l=(int)(year-1970.)/5; <span class="keywordflow">if</span> (l &lt; 0) l=0; <span class="keywordflow">else</span> <span class="keywordflow">if</span> (l &gt;= 7) l=6;
<a name="l00603"></a>00603     <span class="keywordflow">if</span> (l &lt; 2) maxod=8; <span class="keywordflow">else</span> maxod=10;
<a name="l00604"></a>00604     tzero=(double)(l*5 + 1970); <span class="keywordflow">if</span> (l==0) tzero=1965.;
<a name="l00605"></a>00605     <span class="keywordflow">if</span> ((year&lt;1955.) || (year&gt;2005.))
<a name="l00606"></a>00606         fprintf(stderr, <span class="stringliteral">&quot;sigrf: IGRF not available for %8.3lf\n&quot;</span>, year);
<a name="l00607"></a>00607     <span class="keywordflow">for</span> (i=0, n=1; n&lt;=maxod; n++) {
<a name="l00608"></a>00608         vgh[0][n]=rf[l][i];
<a name="l00609"></a>00609         <span class="keywordflow">if</span> (n&lt;=8) <a class="code" href="namespaceigrf.html#aa95a5325587e6e46b60fdfbc45bccb36">vght</a>[0][n]=sv[l][i]; <span class="keywordflow">else</span> <a class="code" href="namespaceigrf.html#aa95a5325587e6e46b60fdfbc45bccb36">vght</a>[0][n]=0.;
<a name="l00610"></a>00610         i++;
<a name="l00611"></a>00611         <span class="keywordflow">for</span> (m=1; m&lt;=n; m++) {
<a name="l00612"></a>00612             vgh[m][n]=rf[l][i];
<a name="l00613"></a>00613             <span class="keywordflow">if</span> (n&lt;=8) <a class="code" href="namespaceigrf.html#aa95a5325587e6e46b60fdfbc45bccb36">vght</a>[m][n]=sv[l][i]; <span class="keywordflow">else</span> <a class="code" href="namespaceigrf.html#aa95a5325587e6e46b60fdfbc45bccb36">vght</a>[m][n]=0.;
<a name="l00614"></a>00614             i++;
<a name="l00615"></a>00615             vgh[n][m-1]=rf[l][i];
<a name="l00616"></a>00616             <span class="keywordflow">if</span> (n&lt;=8) <a class="code" href="namespaceigrf.html#aa95a5325587e6e46b60fdfbc45bccb36">vght</a>[n][m-1]=sv[l][i]; <span class="keywordflow">else</span> <a class="code" href="namespaceigrf.html#aa95a5325587e6e46b60fdfbc45bccb36">vght</a>[n][m-1]=0.;
<a name="l00617"></a>00617             i++;
<a name="l00618"></a>00618         }
<a name="l00619"></a>00619     }
<a name="l00620"></a>00620     <a class="code" href="namespaceigrf.html#af39a8523c9c204bca69a99dda2956b6c">field</a>(6378.16, 298.25, 6371.2, maxod);
<a name="l00621"></a>00621     <a class="code" href="namespaceigrf.html#a61593015602f60e05150b6d883268b41">tcoef</a>(vgh, <a class="code" href="namespaceigrf.html#aa95a5325587e6e46b60fdfbc45bccb36">vght</a>, tzero, 0, dmy); <a class="code" href="namespaceigrf.html#a5bb32a15af56d15180a5353a06be99d9">tyear</a>(year);
<a name="l00622"></a>00622 }
<a name="l00623"></a>00623 
<a name="l00624"></a><a class="code" href="namespaceigrf.html#aac39e6ac10a2932cbe2ee617852d69be">00624</a> <span class="keywordtype">void</span> <a class="code" href="namespaceigrf.html#aac39e6ac10a2932cbe2ee617852d69be">sdgrf</a>(<span class="keywordtype">double</span> year)
<a name="l00625"></a>00625 {   <span class="keywordtype">int</span> i, n, m, l;
<a name="l00626"></a>00626     <span class="keywordtype">double</span> dmy[3];
<a name="l00627"></a>00627     l=(int)(year-1945.)/5; <span class="keywordflow">if</span> (l &lt; 0) l=0; <span class="keywordflow">else</span> <span class="keywordflow">if</span> (l &gt;= 9) l=8;
<a name="l00628"></a>00628     <span class="keywordflow">if</span> ((year&lt;1945.) || (year&gt;1990.))
<a name="l00629"></a>00629         fprintf(stderr, <span class="stringliteral">&quot;sdgrf: DGRF not available for %8.3lf\n&quot;</span>, year);
<a name="l00630"></a>00630     <span class="keywordflow">for</span> (i=0, n=1; n&lt;=10; n++) {
<a name="l00631"></a>00631         vgh[0][n]=df[l][i]; <a class="code" href="namespaceigrf.html#aa95a5325587e6e46b60fdfbc45bccb36">vght</a>[0][n]=(df[l+1][i]-df[l][i])/5.; i++;
<a name="l00632"></a>00632         <span class="keywordflow">for</span> (m=1; m&lt;=n; m++) {
<a name="l00633"></a>00633             vgh[m][n]=df[l][i]; <a class="code" href="namespaceigrf.html#aa95a5325587e6e46b60fdfbc45bccb36">vght</a>[m][n]=(df[l+1][i]-df[l][i])/5.; i++;
<a name="l00634"></a>00634             vgh[n][m-1]=df[l][i]; <a class="code" href="namespaceigrf.html#aa95a5325587e6e46b60fdfbc45bccb36">vght</a>[n][m-1]=(df[l+1][i]-df[l][i])/5.; i++;
<a name="l00635"></a>00635         }
<a name="l00636"></a>00636     }
<a name="l00637"></a>00637     <a class="code" href="namespaceigrf.html#af39a8523c9c204bca69a99dda2956b6c">field</a>(6378.16, 298.25, 6371.2, 10);
<a name="l00638"></a>00638     <a class="code" href="namespaceigrf.html#a61593015602f60e05150b6d883268b41">tcoef</a>(vgh, <a class="code" href="namespaceigrf.html#aa95a5325587e6e46b60fdfbc45bccb36">vght</a>, (<span class="keywordtype">double</span>)(1945+l*5), 0, dmy); <a class="code" href="namespaceigrf.html#a5bb32a15af56d15180a5353a06be99d9">tyear</a>(year);
<a name="l00639"></a>00639 }
<a name="l00640"></a>00640 
<a name="l00641"></a><a class="code" href="namespaceigrf.html#a9b62624726a4695f3ab5b9efad75a53b">00641</a> <span class="keywordtype">void</span> <a class="code" href="namespaceigrf.html#a9b62624726a4695f3ab5b9efad75a53b">spgrf</a>(<span class="keywordtype">double</span> year)
<a name="l00642"></a>00642 {   <span class="keywordtype">int</span> i, n, m, l;
<a name="l00643"></a>00643     <span class="keywordtype">double</span> dmy[3];
<a name="l00644"></a>00644     l=(int)(year-1945.)/5; <span class="keywordflow">if</span> (l &lt; 6) l=6; <span class="keywordflow">else</span> <span class="keywordflow">if</span> (l &gt;= 10) l=9;
<a name="l00645"></a>00645     <span class="keywordflow">if</span> ((year&lt;1975.) || (year&gt;1995.))
<a name="l00646"></a>00646         fprintf(stderr, <span class="stringliteral">&quot;spgrf: PGRF not available for %8.3lf\n&quot;</span>, year);
<a name="l00647"></a>00647     <span class="keywordflow">for</span> (i=0, n=1; n&lt;=10; n++) {
<a name="l00648"></a>00648         vgh[0][n]=df[l][i]; <a class="code" href="namespaceigrf.html#aa95a5325587e6e46b60fdfbc45bccb36">vght</a>[0][n]=(rf[l-4][i]-df[l][i])/5.; i++;
<a name="l00649"></a>00649         <span class="keywordflow">for</span> (m=1; m&lt;=n; m++) {
<a name="l00650"></a>00650             vgh[m][n]=df[l][i]; <a class="code" href="namespaceigrf.html#aa95a5325587e6e46b60fdfbc45bccb36">vght</a>[m][n]=(rf[l-4][i]-df[l][i])/5.; i++;
<a name="l00651"></a>00651             vgh[n][m-1]=df[l][i]; <a class="code" href="namespaceigrf.html#aa95a5325587e6e46b60fdfbc45bccb36">vght</a>[n][m-1]=(rf[l-4][i]-df[l][i])/5.; i++;
<a name="l00652"></a>00652         }
<a name="l00653"></a>00653     }
<a name="l00654"></a>00654     <a class="code" href="namespaceigrf.html#af39a8523c9c204bca69a99dda2956b6c">field</a>(6378.16, 298.25, 6371.2, 10);
<a name="l00655"></a>00655     <a class="code" href="namespaceigrf.html#a61593015602f60e05150b6d883268b41">tcoef</a>(vgh, <a class="code" href="namespaceigrf.html#aa95a5325587e6e46b60fdfbc45bccb36">vght</a>, (<span class="keywordtype">double</span>)(1945+l*5), 0, dmy); <a class="code" href="namespaceigrf.html#a5bb32a15af56d15180a5353a06be99d9">tyear</a>(year);
<a name="l00656"></a>00656 }
<a name="l00657"></a>00657 
<a name="l00658"></a>00658 <span class="comment">/*------------------------*/</span>
<a name="l00659"></a>00659 <span class="comment">/*   FORTRAN Interfaces   */</span>
<a name="l00660"></a>00660 <span class="comment">/*------------------------*/</span>
<a name="l00661"></a>00661 
<a name="l00662"></a>00662 <span class="comment">/*</span>
<a name="l00663"></a>00663 <span class="comment">void gigrf_(int *gen, float *year) { gigrf(*gen, (double)*year); }</span>
<a name="l00664"></a>00664 <span class="comment">void igrfc_(float *fi, float *fk, float *h, float *f)</span>
<a name="l00665"></a>00665 <span class="comment">    { double df; igrfc((double)*fi,(double)*fk,(double)*h,&amp;df); *f=df; }</span>
<a name="l00666"></a>00666 <span class="comment">void igrfm_(float fm[6])</span>
<a name="l00667"></a>00667 <span class="comment">    { double dfm[6]; int i; igrfm(dfm); for (i=0; i&lt;6; i++) fm[i]=dfm[i]; }</span>
<a name="l00668"></a>00668 <span class="comment">void sigrf_(float *year) { sigrf((double)*year); }</span>
<a name="l00669"></a>00669 <span class="comment">void sdgrf_(float *year) { sdgrf((double)*year); }</span>
<a name="l00670"></a>00670 <span class="comment">void spgrf_(float *year) { spgrf((double)*year); }</span>
<a name="l00671"></a>00671 <span class="comment">*/</span>
<a name="l00672"></a>00672 
<a name="l00673"></a>00673 <span class="comment">/*</span>
<a name="l00674"></a>00674 <span class="comment">int main(void)</span>
<a name="l00675"></a>00675 <span class="comment">{</span>
<a name="l00676"></a>00676 <span class="comment">        double f;</span>
<a name="l00677"></a>00677 <span class="comment">        double fm[6];</span>
<a name="l00678"></a>00678 <span class="comment">        int i, j;</span>
<a name="l00679"></a>00679 <span class="comment">        double temp;</span>
<a name="l00680"></a>00680 <span class="comment"></span>
<a name="l00681"></a>00681 <span class="comment">        for(j=0;j&lt;10;j++){</span>
<a name="l00682"></a>00682 <span class="comment">                temp = 2009+0.1*j;</span>
<a name="l00683"></a>00683 <span class="comment">                gigrf(10, temp);</span>
<a name="l00684"></a>00684 <span class="comment">                igrfc(38, 135, 650000,&amp;f);      //Executeはこの中に含む</span>
<a name="l00685"></a>00685 <span class="comment">                igrfm(fm);</span>
<a name="l00686"></a>00686 <span class="comment">                printf(&quot;%lf\n&quot;, temp);</span>
<a name="l00687"></a>00687 <span class="comment">                for(i=0;i&lt;6;i++){</span>
<a name="l00688"></a>00688 <span class="comment">                        printf(&quot;fm[%d]=%lf\n&quot;, i, fm[i]);</span>
<a name="l00689"></a>00689 <span class="comment">                }</span>
<a name="l00690"></a>00690 <span class="comment">        }</span>
<a name="l00691"></a>00691 <span class="comment"></span>
<a name="l00692"></a>00692 <span class="comment">}</span>
<a name="l00693"></a>00693 <span class="comment">*/</span>
<a name="l00694"></a>00694 
<a name="l00695"></a>00695 <span class="comment">//地磁気要素（地心表現）をECI座標へ</span>
<a name="l00696"></a><a class="code" href="namespaceigrf.html#a0d40e4ff230cd89d40dc1670214e2fa9">00696</a> <span class="keywordtype">int</span> <a class="code" href="namespaceigrf.html#a0d40e4ff230cd89d40dc1670214e2fa9">TransMagaxisToECI</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>* <a class="code" href="namespacesgp4.html#ab3dbec9b4b204d257df654a8f600b15b">mag</a>, <span class="keywordtype">double</span>* pos, <span class="keywordtype">double</span> lonrad, <span class="keywordtype">double</span> thetarad, <span class="keywordtype">double</span> gmst)
<a name="l00697"></a>00697 {
<a name="l00698"></a>00698         <a class="code" href="namespacesgp4.html#ad01ceb467c3d61ff41dc8284b062c29f">RotationY</a>(mag, pos, 180*<a class="code" href="igrf_8cpp.html#af7e8592d0a634bd3642e9fd508ea8022">DEG2RAD</a>-thetarad);
<a name="l00699"></a>00699         <a class="code" href="namespacesgp4.html#a7d8c97a0bbbff0e1ab6789977455fb65">RotationZ</a>(pos, pos,-lonrad);
<a name="l00700"></a>00700         <a class="code" href="namespacesgp4.html#a7d8c97a0bbbff0e1ab6789977455fb65">RotationZ</a>(pos, pos,-gmst);
<a name="l00701"></a>00701 
<a name="l00702"></a>00702         <span class="keywordflow">return</span> 0;
<a name="l00703"></a>00703 }
<a name="l00704"></a>00704 
<a name="l00705"></a>00705 <span class="comment">//IGRFの計算を実行するメインルーチン</span>
<a name="l00706"></a>00706 <span class="comment">//Output        :       mag[3]  ECI座標での磁界の値[nT]</span>
<a name="l00707"></a><a class="code" href="namespaceigrf.html#a9e7c2ebf30af9193a48f505977f46a93">00707</a> <span class="keywordtype">void</span> <a class="code" href="namespaceigrf.html#a9e7c2ebf30af9193a48f505977f46a93">IgrfCalc</a>(<span class="keywordtype">double</span> decyear, <span class="keywordtype">double</span> latrad, <span class="keywordtype">double</span> lonrad, <span class="keywordtype">double</span> alt, <span class="keywordtype">double</span> side, <span class="keywordtype">double</span>* <a class="code" href="namespacesgp4.html#ab3dbec9b4b204d257df654a8f600b15b">mag</a>)
<a name="l00708"></a>00708 {
<a name="l00709"></a>00709         <span class="keyword">static</span> <span class="keywordtype">bool</span> first_flg = <span class="keyword">true</span>;
<a name="l00710"></a>00710 
<a name="l00711"></a>00711         <span class="keywordtype">double</span> <a class="code" href="namespaceigrf.html#a804225ad2942311ba664c4a09e5cd887">f</a>;
<a name="l00712"></a>00712 
<a name="l00713"></a>00713         <span class="keywordflow">if</span>(first_flg==<span class="keyword">true</span>) {
<a name="l00714"></a>00714                 <a class="code" href="namespaceigrf.html#af2761a05a655cde14b9f8a15b00f582a">gigrf</a>(10, decyear);     <span class="comment">//ファイル読み込み</span>
<a name="l00715"></a>00715                 first_flg = <span class="keyword">false</span>;
<a name="l00716"></a>00716         }
<a name="l00717"></a>00717         <a class="code" href="namespaceigrf.html#a5bb32a15af56d15180a5353a06be99d9">tyear</a>(decyear);                 <span class="comment">//実行年の設定</span>
<a name="l00718"></a>00718         <a class="code" href="namespaceigrf.html#aa5947f7656470b8ad4c038aeee4ea925">igrfc</a>(latrad*<a class="code" href="igrf_8cpp.html#ac5a945020d3528355cda82d383676736">RAD2DEG</a>, lonrad*RAD2DEG, alt*1000,&amp;f);     <span class="comment">//実行位置の設定&amp;Executeはこの中に含む</span>
<a name="l00719"></a>00719 
<a name="l00720"></a>00720         mag[0] = x;     <span class="comment">//x, y, zはigrf.cppグローバル変数</span>
<a name="l00721"></a>00721         mag[1] = <a class="code" href="namespaceigrf.html#aef378991c40e0acdd01f61c2ef7d3976">y</a>;
<a name="l00722"></a>00722         mag[2] = <a class="code" href="namespaceigrf.html#a331e204532a196349922b6ceb77bfd26">z</a>;
<a name="l00723"></a>00723         <span class="keywordtype">double</span> thetarad = acos(<a class="code" href="namespaceigrf.html#ae49465fde6b2fbd446b9992e3d296ff8">cth</a>); <span class="comment">//[0&lt;=theta&lt;=pi?]</span>
<a name="l00724"></a>00724 
<a name="l00725"></a>00725         <a class="code" href="namespaceigrf.html#a53250eac53c1650b294f9ccdc8660dda">testglobal</a>[0] = mag[0];
<a name="l00726"></a>00726         <a class="code" href="namespaceigrf.html#a53250eac53c1650b294f9ccdc8660dda">testglobal</a>[1] = mag[1];
<a name="l00727"></a>00727         <a class="code" href="namespaceigrf.html#a53250eac53c1650b294f9ccdc8660dda">testglobal</a>[2] = mag[2];
<a name="l00728"></a>00728 
<a name="l00729"></a>00729         <a class="code" href="namespaceigrf.html#a0d40e4ff230cd89d40dc1670214e2fa9">TransMagaxisToECI</a>(mag, mag, lonrad, thetarad, side);
<a name="l00730"></a>00730 
<a name="l00731"></a>00731 }
<a name="l00732"></a>00732 
<a name="l00733"></a>00733 } <span class="comment">/* end of namespace igrf */</span>
</pre></div></div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>全て</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>クラス</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>ネームスペース</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>ファイル</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>関数</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>変数</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>型定義</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>列挙型</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>列挙型の値</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>フレンド</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>マクロ定義</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>STFに対してTue Mar 1 2011 03:45:40に生成されました。&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
